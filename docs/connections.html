<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>The R in Spark: Learning Apache Spark with R</title>
  <meta name="description" content="A book to learn Apache Spark with R using the sparklyr R package.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="The R in Spark: Learning Apache Spark with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A book to learn Apache Spark with R using the sparklyr R package." />
  <meta name="github-repo" content="javierluraschi/the-r-in-spark" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="The R in Spark: Learning Apache Spark with R" />
  
  <meta name="twitter:description" content="A book to learn Apache Spark with R using the sparklyr R package." />
  

<meta name="author" content="Javier Luraschi">


<meta name="date" content="2018-09-23">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="clusters.html">
<link rel="next" href="data.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="libs/r2d3-render-0.1.0/r2d3-render.js"></script>
<script src="libs/webcomponents-2.0.0/webcomponents.js"></script>
<script src="libs/r2d3-binding-0.2.2/r2d3.js"></script>
<script src="libs/d3v5-5.0.0/d3.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#intro-background"><i class="fa fa-check"></i><b>1.1</b> Background</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#spark"><i class="fa fa-check"></i><b>1.2</b> Spark</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#r"><i class="fa fa-check"></i><b>1.3</b> R</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#sparklyr"><i class="fa fa-check"></i><b>1.4</b> sparklyr</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>2</b> Installation</a><ul>
<li class="chapter" data-level="2.1" data-path="installation.html"><a href="installation.html#prerequisites"><i class="fa fa-check"></i><b>2.1</b> Prerequisites</a><ul>
<li class="chapter" data-level="2.1.1" data-path="installation.html"><a href="installation.html#install-r"><i class="fa fa-check"></i><b>2.1.1</b> Install R</a></li>
<li class="chapter" data-level="2.1.2" data-path="installation.html"><a href="installation.html#install-java"><i class="fa fa-check"></i><b>2.1.2</b> Install Java</a></li>
<li class="chapter" data-level="2.1.3" data-path="installation.html"><a href="installation.html#install-rstudio"><i class="fa fa-check"></i><b>2.1.3</b> Install RStudio</a></li>
<li class="chapter" data-level="2.1.4" data-path="installation.html"><a href="installation.html#install-sparklyr"><i class="fa fa-check"></i><b>2.1.4</b> Install sparklyr</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="installation.html"><a href="installation.html#installing-spark"><i class="fa fa-check"></i><b>2.2</b> Installing Spark</a></li>
<li class="chapter" data-level="2.3" data-path="installation.html"><a href="installation.html#connecting-to-spark"><i class="fa fa-check"></i><b>2.3</b> Connecting to Spark</a></li>
<li class="chapter" data-level="2.4" data-path="installation.html"><a href="installation.html#using-spark"><i class="fa fa-check"></i><b>2.4</b> Using Spark</a><ul>
<li class="chapter" data-level="2.4.1" data-path="installation.html"><a href="installation.html#spark-web-interface"><i class="fa fa-check"></i><b>2.4.1</b> Web Interface</a></li>
<li class="chapter" data-level="2.4.2" data-path="installation.html"><a href="installation.html#logs"><i class="fa fa-check"></i><b>2.4.2</b> Logs</a></li>
<li class="chapter" data-level="2.4.3" data-path="installation.html"><a href="installation.html#using-spark-from-rstudio"><i class="fa fa-check"></i><b>2.4.3</b> RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="installation.html"><a href="installation.html#disconnecting"><i class="fa fa-check"></i><b>2.5</b> Disconnecting</a></li>
<li class="chapter" data-level="2.6" data-path="installation.html"><a href="installation.html#recap"><i class="fa fa-check"></i><b>2.6</b> Recap</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="analysis.html"><a href="analysis.html"><i class="fa fa-check"></i><b>3</b> Analysis</a><ul>
<li class="chapter" data-level="3.1" data-path="analysis.html"><a href="analysis.html#overview"><i class="fa fa-check"></i><b>3.1</b> Overview</a></li>
<li class="chapter" data-level="3.2" data-path="analysis.html"><a href="analysis.html#dplyr"><i class="fa fa-check"></i><b>3.2</b> dplyr</a><ul>
<li class="chapter" data-level="3.2.1" data-path="analysis.html"><a href="analysis.html#pass-through-functions"><i class="fa fa-check"></i><b>3.2.1</b> Pass-through Functions</a></li>
<li class="chapter" data-level="3.2.2" data-path="analysis.html"><a href="analysis.html#dplyr-reosurces"><i class="fa fa-check"></i><b>3.2.2</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="analysis.html"><a href="analysis.html#dbi"><i class="fa fa-check"></i><b>3.3</b> DBI</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modeling.html"><a href="modeling.html"><i class="fa fa-check"></i><b>4</b> Modeling</a><ul>
<li class="chapter" data-level="4.1" data-path="modeling.html"><a href="modeling.html#overview-1"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="modeling.html"><a href="modeling.html#supervised"><i class="fa fa-check"></i><b>4.2</b> Supervised</a></li>
<li class="chapter" data-level="4.3" data-path="modeling.html"><a href="modeling.html#unsupervised"><i class="fa fa-check"></i><b>4.3</b> Unsupervised</a><ul>
<li class="chapter" data-level="4.3.1" data-path="modeling.html"><a href="modeling.html#k-means-clustering"><i class="fa fa-check"></i><b>4.3.1</b> K-Means Clustering</a></li>
<li class="chapter" data-level="4.3.2" data-path="modeling.html"><a href="modeling.html#gaussian-mixture-clustering"><i class="fa fa-check"></i><b>4.3.2</b> Gaussian Mixture Clustering</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="modeling.html"><a href="modeling.html#broom"><i class="fa fa-check"></i><b>4.4</b> Broom</a></li>
<li class="chapter" data-level="4.5" data-path="modeling.html"><a href="modeling.html#pipelines"><i class="fa fa-check"></i><b>4.5</b> Pipelines</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="clusters.html"><a href="clusters.html"><i class="fa fa-check"></i><b>5</b> Clusters</a><ul>
<li class="chapter" data-level="5.1" data-path="clusters.html"><a href="clusters.html#overview-2"><i class="fa fa-check"></i><b>5.1</b> Overview</a></li>
<li class="chapter" data-level="5.2" data-path="clusters.html"><a href="clusters.html#managers"><i class="fa fa-check"></i><b>5.2</b> Managers</a><ul>
<li class="chapter" data-level="5.2.1" data-path="clusters.html"><a href="clusters.html#clusters-standalone"><i class="fa fa-check"></i><b>5.2.1</b> Standalone</a></li>
<li class="chapter" data-level="5.2.2" data-path="clusters.html"><a href="clusters.html#yarn"><i class="fa fa-check"></i><b>5.2.2</b> Yarn</a></li>
<li class="chapter" data-level="5.2.3" data-path="clusters.html"><a href="clusters.html#mesos"><i class="fa fa-check"></i><b>5.2.3</b> Mesos</a></li>
<li class="chapter" data-level="5.2.4" data-path="clusters.html"><a href="clusters.html#kubernetes"><i class="fa fa-check"></i><b>5.2.4</b> Kubernetes</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="clusters.html"><a href="clusters.html#on-premise"><i class="fa fa-check"></i><b>5.3</b> On-Premise</a><ul>
<li class="chapter" data-level="5.3.1" data-path="clusters.html"><a href="clusters.html#cloudera"><i class="fa fa-check"></i><b>5.3.1</b> Cloudera</a></li>
<li class="chapter" data-level="5.3.2" data-path="clusters.html"><a href="clusters.html#hortonworks"><i class="fa fa-check"></i><b>5.3.2</b> Hortonworks</a></li>
<li class="chapter" data-level="5.3.3" data-path="clusters.html"><a href="clusters.html#mapr"><i class="fa fa-check"></i><b>5.3.3</b> MapR</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="clusters.html"><a href="clusters.html#cloud"><i class="fa fa-check"></i><b>5.4</b> Cloud</a><ul>
<li class="chapter" data-level="5.4.1" data-path="clusters.html"><a href="clusters.html#amazon"><i class="fa fa-check"></i><b>5.4.1</b> Amazon</a></li>
<li class="chapter" data-level="5.4.2" data-path="clusters.html"><a href="clusters.html#google"><i class="fa fa-check"></i><b>5.4.2</b> Google</a></li>
<li class="chapter" data-level="5.4.3" data-path="clusters.html"><a href="clusters.html#microsoft"><i class="fa fa-check"></i><b>5.4.3</b> Microsoft</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="clusters.html"><a href="clusters.html#tools"><i class="fa fa-check"></i><b>5.5</b> Tools</a><ul>
<li class="chapter" data-level="5.5.1" data-path="clusters.html"><a href="clusters.html#rstudio"><i class="fa fa-check"></i><b>5.5.1</b> RStudio</a></li>
<li class="chapter" data-level="5.5.2" data-path="clusters.html"><a href="clusters.html#clusters-livy"><i class="fa fa-check"></i><b>5.5.2</b> Livy</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="clusters.html"><a href="clusters.html#recap-1"><i class="fa fa-check"></i><b>5.6</b> Recap</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="connections.html"><a href="connections.html"><i class="fa fa-check"></i><b>6</b> Connections</a><ul>
<li class="chapter" data-level="6.1" data-path="connections.html"><a href="connections.html#overview-3"><i class="fa fa-check"></i><b>6.1</b> Overview</a><ul>
<li class="chapter" data-level="6.1.1" data-path="connections.html"><a href="connections.html#edge-nodes"><i class="fa fa-check"></i><b>6.1.1</b> Edge Nodes</a></li>
<li class="chapter" data-level="6.1.2" data-path="connections.html"><a href="connections.html#spark-home"><i class="fa fa-check"></i><b>6.1.2</b> Spark Home</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="connections.html"><a href="connections.html#types"><i class="fa fa-check"></i><b>6.2</b> Types</a><ul>
<li class="chapter" data-level="6.2.1" data-path="connections.html"><a href="connections.html#connection-local"><i class="fa fa-check"></i><b>6.2.1</b> Local</a></li>
<li class="chapter" data-level="6.2.2" data-path="connections.html"><a href="connections.html#standalone"><i class="fa fa-check"></i><b>6.2.2</b> Standalone</a></li>
<li class="chapter" data-level="6.2.3" data-path="connections.html"><a href="connections.html#yarn-1"><i class="fa fa-check"></i><b>6.2.3</b> Yarn</a></li>
<li class="chapter" data-level="6.2.4" data-path="connections.html"><a href="connections.html#livy"><i class="fa fa-check"></i><b>6.2.4</b> Livy</a></li>
<li class="chapter" data-level="6.2.5" data-path="connections.html"><a href="connections.html#mesos-1"><i class="fa fa-check"></i><b>6.2.5</b> Mesos</a></li>
<li class="chapter" data-level="6.2.6" data-path="connections.html"><a href="connections.html#kubernetes-1"><i class="fa fa-check"></i><b>6.2.6</b> Kubernetes</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="connections.html"><a href="connections.html#troubleshooting"><i class="fa fa-check"></i><b>6.3</b> Troubleshooting</a><ul>
<li class="chapter" data-level="6.3.1" data-path="connections.html"><a href="connections.html#logging"><i class="fa fa-check"></i><b>6.3.1</b> Logging</a></li>
<li class="chapter" data-level="6.3.2" data-path="connections.html"><a href="connections.html#troubleshoot-spark-submit"><i class="fa fa-check"></i><b>6.3.2</b> Spark Submit</a></li>
<li class="chapter" data-level="6.3.3" data-path="connections.html"><a href="connections.html#multiple"><i class="fa fa-check"></i><b>6.3.3</b> Multiple</a></li>
<li class="chapter" data-level="6.3.4" data-path="connections.html"><a href="connections.html#windows"><i class="fa fa-check"></i><b>6.3.4</b> Windows</a></li>
<li class="chapter" data-level="6.3.5" data-path="connections.html"><a href="connections.html#submit-manually"><i class="fa fa-check"></i><b>6.3.5</b> Submit Manually</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="connections.html"><a href="connections.html#recap-2"><i class="fa fa-check"></i><b>6.4</b> Recap</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>7</b> Data</a><ul>
<li class="chapter" data-level="7.1" data-path="data.html"><a href="data.html#overview-4"><i class="fa fa-check"></i><b>7.1</b> Overview</a></li>
<li class="chapter" data-level="7.2" data-path="data.html"><a href="data.html#dataframes"><i class="fa fa-check"></i><b>7.2</b> DataFrames</a><ul>
<li class="chapter" data-level="7.2.1" data-path="data.html"><a href="data.html#data-sdf-functions"><i class="fa fa-check"></i><b>7.2.1</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="data.html"><a href="data.html#formats"><i class="fa fa-check"></i><b>7.3</b> Formats</a></li>
<li class="chapter" data-level="7.4" data-path="data.html"><a href="data.html#external"><i class="fa fa-check"></i><b>7.4</b> External</a><ul>
<li class="chapter" data-level="7.4.1" data-path="data.html"><a href="data.html#amazon-s3"><i class="fa fa-check"></i><b>7.4.1</b> Amazon S3</a></li>
<li class="chapter" data-level="7.4.2" data-path="data.html"><a href="data.html#cassandra"><i class="fa fa-check"></i><b>7.4.2</b> Cassandra</a></li>
<li class="chapter" data-level="7.4.3" data-path="data.html"><a href="data.html#databases"><i class="fa fa-check"></i><b>7.4.3</b> Databases</a></li>
<li class="chapter" data-level="7.4.4" data-path="data.html"><a href="data.html#hbase"><i class="fa fa-check"></i><b>7.4.4</b> HBase</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="data.html"><a href="data.html#troubleshooting-1"><i class="fa fa-check"></i><b>7.5</b> Troubleshooting</a><ul>
<li class="chapter" data-level="7.5.1" data-path="data.html"><a href="data.html#troubleshoot-csvs"><i class="fa fa-check"></i><b>7.5.1</b> Troubleshoot CSVs</a></li>
<li class="chapter" data-level="7.5.2" data-path="data.html"><a href="data.html#column-names"><i class="fa fa-check"></i><b>7.5.2</b> Column Names</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="data.html"><a href="data.html#recap-3"><i class="fa fa-check"></i><b>7.6</b> Recap</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="tuning.html"><a href="tuning.html"><i class="fa fa-check"></i><b>8</b> Tuning</a><ul>
<li class="chapter" data-level="8.1" data-path="tuning.html"><a href="tuning.html#overview-5"><i class="fa fa-check"></i><b>8.1</b> Overview</a><ul>
<li class="chapter" data-level="8.1.1" data-path="tuning.html"><a href="tuning.html#tunning-graph-vusualization"><i class="fa fa-check"></i><b>8.1.1</b> Graph Visualization</a></li>
<li class="chapter" data-level="8.1.2" data-path="tuning.html"><a href="tuning.html#tunning-event-timeline"><i class="fa fa-check"></i><b>8.1.2</b> Event Timeline</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="tuning.html"><a href="tuning.html#tunning-configuring"><i class="fa fa-check"></i><b>8.2</b> Configuring</a><ul>
<li class="chapter" data-level="8.2.1" data-path="tuning.html"><a href="tuning.html#submit-settings"><i class="fa fa-check"></i><b>8.2.1</b> Submit Settings</a></li>
<li class="chapter" data-level="8.2.2" data-path="tuning.html"><a href="tuning.html#runtime-settings"><i class="fa fa-check"></i><b>8.2.2</b> Runtime Settings</a></li>
<li class="chapter" data-level="8.2.3" data-path="tuning.html"><a href="tuning.html#sparklyr-settings"><i class="fa fa-check"></i><b>8.2.3</b> Sparklyr Settings</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="tuning.html"><a href="tuning.html#tunning-partitioning"><i class="fa fa-check"></i><b>8.3</b> Partitioning</a><ul>
<li class="chapter" data-level="8.3.1" data-path="tuning.html"><a href="tuning.html#implicit"><i class="fa fa-check"></i><b>8.3.1</b> Implicit</a></li>
<li class="chapter" data-level="8.3.2" data-path="tuning.html"><a href="tuning.html#explicit"><i class="fa fa-check"></i><b>8.3.2</b> Explicit</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="tuning.html"><a href="tuning.html#tunning-caching"><i class="fa fa-check"></i><b>8.4</b> Caching</a><ul>
<li class="chapter" data-level="8.4.1" data-path="tuning.html"><a href="tuning.html#checkpointing"><i class="fa fa-check"></i><b>8.4.1</b> Checkpointing</a></li>
<li class="chapter" data-level="8.4.2" data-path="tuning.html"><a href="tuning.html#tunning-memory"><i class="fa fa-check"></i><b>8.4.2</b> Memory</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="tuning.html"><a href="tuning.html#tunning-shuffling"><i class="fa fa-check"></i><b>8.5</b> Shuffling</a></li>
<li class="chapter" data-level="8.6" data-path="tuning.html"><a href="tuning.html#tunning-serialization"><i class="fa fa-check"></i><b>8.6</b> Serialization</a></li>
<li class="chapter" data-level="8.7" data-path="tuning.html"><a href="tuning.html#recap-4"><i class="fa fa-check"></i><b>8.7</b> Recap</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="extensions.html"><a href="extensions.html"><i class="fa fa-check"></i><b>9</b> Extensions</a><ul>
<li class="chapter" data-level="9.1" data-path="extensions.html"><a href="extensions.html#using-extensions"><i class="fa fa-check"></i><b>9.1</b> Using Extensions</a><ul>
<li class="chapter" data-level="9.1.1" data-path="extensions.html"><a href="extensions.html#rsparkling"><i class="fa fa-check"></i><b>9.1.1</b> RSparkling</a></li>
<li class="chapter" data-level="9.1.2" data-path="extensions.html"><a href="extensions.html#graphframes"><i class="fa fa-check"></i><b>9.1.2</b> GraphFrames</a></li>
<li class="chapter" data-level="9.1.3" data-path="extensions.html"><a href="extensions.html#mleap"><i class="fa fa-check"></i><b>9.1.3</b> Mleap</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="extensions.html"><a href="extensions.html#custom-extensions"><i class="fa fa-check"></i><b>9.2</b> Writting Extensions</a><ul>
<li class="chapter" data-level="9.2.1" data-path="extensions.html"><a href="extensions.html#rstudio-projects"><i class="fa fa-check"></i><b>9.2.1</b> RStudio Projects</a></li>
<li class="chapter" data-level="9.2.2" data-path="extensions.html"><a href="extensions.html#troubleshooting-2"><i class="fa fa-check"></i><b>9.2.2</b> Troubleshooting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="distributed.html"><a href="distributed.html"><i class="fa fa-check"></i><b>10</b> Distributed R</a><ul>
<li class="chapter" data-level="10.1" data-path="distributed.html"><a href="distributed.html#use-cases"><i class="fa fa-check"></i><b>10.1</b> Use Cases</a></li>
<li class="chapter" data-level="10.2" data-path="distributed.html"><a href="distributed.html#columns"><i class="fa fa-check"></i><b>10.2</b> Columns</a><ul>
<li class="chapter" data-level="10.2.1" data-path="distributed.html"><a href="distributed.html#inference"><i class="fa fa-check"></i><b>10.2.1</b> Inference</a></li>
<li class="chapter" data-level="10.2.2" data-path="distributed.html"><a href="distributed.html#excplicit"><i class="fa fa-check"></i><b>10.2.2</b> Excplicit</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="distributed.html"><a href="distributed.html#grouping"><i class="fa fa-check"></i><b>10.3</b> Grouping</a></li>
<li class="chapter" data-level="10.4" data-path="distributed.html"><a href="distributed.html#packages"><i class="fa fa-check"></i><b>10.4</b> Packages</a></li>
<li class="chapter" data-level="10.5" data-path="distributed.html"><a href="distributed.html#restrictions"><i class="fa fa-check"></i><b>10.5</b> Restrictions</a></li>
<li class="chapter" data-level="10.6" data-path="distributed.html"><a href="distributed.html#troubleshooting-3"><i class="fa fa-check"></i><b>10.6</b> Troubleshooting</a><ul>
<li class="chapter" data-level="10.6.1" data-path="distributed.html"><a href="distributed.html#tips"><i class="fa fa-check"></i><b>10.6.1</b> Tips</a></li>
<li class="chapter" data-level="10.6.2" data-path="distributed.html"><a href="distributed.html#logs-1"><i class="fa fa-check"></i><b>10.6.2</b> Logs</a></li>
<li class="chapter" data-level="10.6.3" data-path="distributed.html"><a href="distributed.html#debugging"><i class="fa fa-check"></i><b>10.6.3</b> Debugging</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="streaming.html"><a href="streaming.html"><i class="fa fa-check"></i><b>11</b> Streaming</a><ul>
<li class="chapter" data-level="11.1" data-path="streaming.html"><a href="streaming.html#overview-6"><i class="fa fa-check"></i><b>11.1</b> Overview</a></li>
<li class="chapter" data-level="11.2" data-path="streaming.html"><a href="streaming.html#transformations"><i class="fa fa-check"></i><b>11.2</b> Transformations</a><ul>
<li class="chapter" data-level="11.2.1" data-path="streaming.html"><a href="streaming.html#streams-dplyr"><i class="fa fa-check"></i><b>11.2.1</b> dplyr</a></li>
<li class="chapter" data-level="11.2.2" data-path="streaming.html"><a href="streaming.html#streams-pipelines"><i class="fa fa-check"></i><b>11.2.2</b> Pipelines</a></li>
<li class="chapter" data-level="11.2.3" data-path="streaming.html"><a href="streaming.html#streams-r"><i class="fa fa-check"></i><b>11.2.3</b> R Code</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="streaming.html"><a href="streaming.html#shiny"><i class="fa fa-check"></i><b>11.3</b> Shiny</a></li>
<li class="chapter" data-level="11.4" data-path="streaming.html"><a href="streaming.html#formats-1"><i class="fa fa-check"></i><b>11.4</b> Formats</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="contributing.html"><a href="contributing.html"><i class="fa fa-check"></i><b>12</b> Contributing</a><ul>
<li class="chapter" data-level="12.1" data-path="contributing.html"><a href="contributing.html#overview-7"><i class="fa fa-check"></i><b>12.1</b> Overview</a></li>
<li class="chapter" data-level="12.2" data-path="contributing.html"><a href="contributing.html#scala"><i class="fa fa-check"></i><b>12.2</b> Scala</a></li>
<li class="chapter" data-level="12.3" data-path="contributing.html"><a href="contributing.html#serialization"><i class="fa fa-check"></i><b>12.3</b> Serialization</a></li>
<li class="chapter" data-level="12.4" data-path="contributing.html"><a href="contributing.html#invocations"><i class="fa fa-check"></i><b>12.4</b> Invocations</a></li>
<li class="chapter" data-level="12.5" data-path="contributing.html"><a href="contributing.html#r-packages"><i class="fa fa-check"></i><b>12.5</b> R Packages</a></li>
<li class="chapter" data-level="12.6" data-path="contributing.html"><a href="contributing.html#connections-1"><i class="fa fa-check"></i><b>12.6</b> Connections</a></li>
<li class="chapter" data-level="12.7" data-path="contributing.html"><a href="contributing.html#distributed-r"><i class="fa fa-check"></i><b>12.7</b> Distributed R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="12.8" data-path="appendix.html"><a href="appendix.html#storage-capacity"><i class="fa fa-check"></i><b>12.8</b> Worlds Store Capacity</a></li>
<li class="chapter" data-level="12.9" data-path="appendix.html"><a href="appendix.html#cran-downloads"><i class="fa fa-check"></i><b>12.9</b> Daily downloads of CRAN packages</a></li>
<li class="chapter" data-level="12.10" data-path="appendix.html"><a href="appendix.html#cluster-trends"><i class="fa fa-check"></i><b>12.10</b> Google trends for mainframes, cloud computing and kubernetes</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The R in Spark: Learning Apache Spark with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="connections" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Connections</h1>
<p>The previous chapter, <a href="clusters.html#clusters">Clusters</a>, presented the major cluster computing paradigms, cluster managers and cluster providers; this section explains the internal components of a Spark cluster and the how to perform connections to any cluster running Apache Spark.</p>
<div id="overview-3" class="section level2">
<h2><span class="header-section-number">6.1</span> Overview</h2>
<p>Before explaining how to connect to Spark clusters, it is worth discussing the components of a Spark cluster and how they interact, this is often known as the cluster architecture of Apache Spark.</p>
<p>First, lets go over a couple definitions. As you know form previous chapters, a cluster is a collection of machines to perform analysis beyond a single computer. However, in distributed systems and clusters literature, we often reffer to each physical machine as a compute instance, compute node, or simply instance or node for short. It is helpful to remind this while reading through this chapter and making use of external resource.</p>
<p>In a Spark cluster, there are three types of compute instances that are relevant to Spark: The <strong>driver node</strong>, the <strong>worker nodes</strong> and the <strong>cluster manager</strong>. A cluster manager is a service that allows Spark to be executed in the clsuter and was explained in the <a href="Managers">Cluster Managers</a> section. The <strong>driver node</strong> is tasked with delegating work to the worker nodes, but also for aggregating their results and controlling computation flow. For the most part, aggregation happens in the worker nodes; however, even after the nodes aggregate data, it is often the case that the driver node would have to collect the worker’s results. Therefore, the driver node usually has at least, but often much more, compute resources (read RAM, CPU, Local Storage, etc.) than the worker node. The <strong>worker nodes</strong> execute compute tasks over partitioned data and communicate intermediate results to other workers or back to the driver node, worker nodes are also reffered as <strong>executors</strong>.</p>
<p>Strictly speaking, the driver node and worker nodes are just names assigned to machines with particular roles, while the actual computation in the driver node is performed by the <strong>spark context</strong>. The Spark context is a Spark component tasked with scheduling tasks, managing data and so on. In the worker nodes, the actual computation is performed under a <strong>spark executor</strong>, which is also a Spark component tasked with executing subtasks against a data partition.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-42"></span>
<div id="htmlwidget-6134db3b7c76e1d1571d" style="width:100%;height:220pt;" class="r2d3 html-widget"></div>
<script type="application/json" data-for="htmlwidget-6134db3b7c76e1d1571d">{"x":{"data":null,"type":"NULL","container":"svg","options":null,"script":"var d3Script = function(d3, r2d3, data, svg, width, height, options, theme, console) {\nthis.d3 = d3;\n/* R2D3 Source File:  images/06-connections-diagram.js */\n\nsvg.append(\"svg:defs\").append(\"svg:marker\")\n  .attr(\"id\", \"circle\")\n  .attr(\"refX\", 6)\n  .attr(\"refY\", 6)\n  .attr(\"markerWidth\", 12)\n  .attr(\"markerHeight\", 12)\n  .attr(\"orient\", \"auto\")\n  .append(\"circle\")\n  .attr(\"cx\", \"6\")\n  .attr(\"cy\", \"6\")\n  .attr(\"r\", \"3\")\n  .attr(\"class\", \"block-link\")\n  .attr(\"stroke-width\", 1);\n\nfunction diagramRoot(maxWidth) {\n  if (!maxWidth) maxWidth = 500;\n\n  var scaleX = 1;\n  var scaleY = 1;\n  height = height - 20;\n\n  var newWidth = width > maxWidth ? maxWidth : width;\n  var translateX = width > newWidth ? (width - newWidth) / 2 : 0;\n  var translateY = 10;\n  width = newWidth;\n\n  svg\n    .attr(\"font-size\", Math.min(width, 500) / 600 + \"em\")\n    .attr(\"font-family\", \"sans-serif\");\n\n  var root = svg.append(\"g\")\n    .attr(\"transform\", \"translate(\" + translateX + \",\" + translateY + \")scale(\" + scaleX + \",\" + scaleY + \")\");\n\n  return root;\n}\n\nfunction drawBlock(parent, block) {\n  if (!block.x) block.x = 0;\n  if (!block.y) block.y = 0;\n  if (!block.width) block.width = blockWidth;\n  if (!block.height) block.height = blockHeight;\n  if (!block.color) block.color = \"#bbcce0\";\n  if (!block.label) block.label = \"<label>\";\n  if (!block.style) block.style = \"block\";\n\n  var startX = block.x - block.width / 2;\n  var startY = block.y - block.height / 2;\n\n  parent.append(\"rect\")\n    .attr(\"x\", startX)\n    .attr(\"y\", startY)\n    .attr(\"width\", block.width)\n    .attr(\"height\", block.height)\n    .attr(\"class\", block.style);\n\n  var current = parent.append(\"text\")\n    .attr(\"x\", block.x)\n    .attr(\"y\", startY + 20)\n    .attr(\"fill\", \"white\")\n    .attr(\"text-anchor\", \"middle\")\n    .text(block.label);\n\n  if (block.childrens) {\n    for (var childIdx in block.childrens) {\n      var child = block.childrens[childIdx];\n\n      if (!child.width) child.width = block.width - 20;\n      if (!child.x) child.x = block.x;\n      if (child.position === undefined) child.position = childIdx;\n      if (child.style === undefined) child.style = \"block-children\";\n\n      var childBlock = {\n        x: child.x,\n        y: startY + 46 + child.position * 34,\n        width: child.width,\n        height: 30,\n        label: child.label,\n        style: child.style\n      };\n\n      drawBlock(parent, childBlock);\n    }\n  }\n\n  return block;\n}\n\nfunction linkBlocks(block1, block2, label) {\n  var block1right = block1.x + block1.width / 2;\n  var block2left = block2.x - block2.width / 2;\n  var block1bottom = block1.y + block1.height / 2;\n  var block2top = block2.y - block2.height / 2;\n\n  var horizontal = block1right < block2left;\n\n  root.append('line')\n    .attr(\"x1\", horizontal ? block1right : block1.x)\n    .attr(\"y1\", horizontal ? block1.y : block1bottom)\n    .attr(\"x2\", horizontal ? block2left : block2.x)\n    .attr(\"y2\", horizontal ? block2.y : block2top)\n  \t.attr(\"class\", \"block-link\")\n  \t.attr(\"stroke-width\", \"1\")\n  \t.attr(\"marker-start\", \"url(#circle)\")\n  \t.attr(\"marker-end\", \"url(#circle)\")\n  \t.attr(\"stroke-dasharray\", \"3,7\");\n\n  var labelFits = horizontal ?\n    Math.abs(block2left - block1right) > block1.width / 2 :\n    Math.abs(block2top - block1bottom) > 30;\n\n  if (label && labelFits) {\n    root.append('text')\n      .attr(\"dy\", (horizontal ? \"-\" : \"\") + \"0.4em\")\n      .attr(\"x\", block1right + (block2left - block1right) / 2)\n      .attr(\"y\", block1bottom + (block2top - block1bottom) / 2)\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"fill\", \"#759cc7\")\n      .text(label);\n  }\n}\nsvg = d3.select(svg.node());\n/* R2D3 Source File:  images/06-connections-architecture.js */\n// !preview r2d3 dependencies=\"images/06-connections-diagram.js\", css=\"images/06-connections-diagram.css\"\n//\n// r2d3: https://rstudio.github.io/r2d3\n//\n\nvar root = diagramRoot();\nvar blockWidth = width / 3.5;\n\nvar totalWorkers = 3;\nvar blockHeight = height / totalWorkers - 10;\n\nvar driverBlock = drawBlock(root, {\n  x: blockWidth / 2,\n  y: height / 2,\n  height: blockHeight,\n  label: \"Driver\",\n  childrens: [{\n    label: \"Spark Context\"\n  }]\n});\n\nvar clusterBlock = drawBlock(root, {\n  x: width / 2,\n  y: height / 2,\n  height: 30,\n  label: \"Cluster Manager\"\n});\n\nvar workers = new Array(totalWorkers);\nfor (var i = 0; i < totalWorkers; i++) {\n  workers[i] = drawBlock(root, {\n    x: width - blockWidth / 2,\n    y: 5 + blockHeight / 2 + height / totalWorkers * i,\n    height: blockHeight,\n    label: \"Worker\",\n    childrens: [{\n      label: \"Spark Executor\",\n      color: \"#759cc7\"\n    }]\n  });\n}\n\nlinkBlocks(driverBlock, clusterBlock);\nfor (var i = 0; i < workers.length; i++) {\n  linkBlocks(clusterBlock, workers[i]);\n}\n};","style":"/* R2D3 Source File:  images/06-connections-diagram.css */\n.block {\n  fill: #bbcce0;\n}\n\n.block-children {\n  fill:  #93acc7;\n}\n\n.block-link {\n  fill: white;\n  stroke: #bbcce0;\n}","version":5,"theme":{"default":{"background":"#FFFFFF","foreground":"#000000"},"runtime":null},"useShadow":true},"evals":[],"jsHooks":[]}</script>
<p class="caption">
FIGURE 6.1: Apache Spark Architecture
</p>
</div>
<p>If you already have an Spark cluster in their organization, you should ask your cluster administrator to provide connection information for this cluster and read carefully their usage policies and constraints. A cluster is usually shared among many users so you want to be respectful of others time and resources while using a shared cluster environment. Your system administrator will describe if it’s an <strong>on-premise</strong> vs <strong>cloud</strong> cluster, the <strong>cluster manager</strong> being used, supported <strong>connections</strong> and supported <strong>tools</strong>. You can use this information to jump directly to <a href="connections.html#connection-local">Local</a>, <a href="connections.html#standalone">Standalone</a>, <a href="connections.html#yarn-1">Yarn</a>, <a href="connections.html#mesos-1">Mesos</a>, <a href="connections.html#livy">Livy</a> or <a href="connections.html#kubernetes-1">Kubernetes</a> based on the information provided to you.</p>
<div id="edge-nodes" class="section level3">
<h3><span class="header-section-number">6.1.1</span> Edge Nodes</h3>
<p>Before connecting to Apache Spark, you will first have to connect to the cluster. Usually, by connecting to an edge node within the cluster. An edge node, is a machine that can accessed from outside the cluster but which is also part of the cluster. There are two methods to connect to this edge instance:</p>
<ul>
<li><strong>Terminal</strong>: Using a <a href="https://en.wikipedia.org/wiki/Computer_terminal">computer terminal</a> applicaiton, one can use a <a href="https://en.wikipedia.org/wiki/Secure_Shell">secure shell</a> to establish a remote connection into the cluster, once you connect into the cluster, you can launch R and then use <code>sparklyr</code>.</li>
<li><strong>Web Browser</strong>: While using <code>sparklyr</code> from a terminal is possible, it is usually more producty to install a <strong>web server</strong> in an edge node that provides more tools and functionality to run R with <code>sparklyr</code>. Most likely, you will want to consider using <a href="RStudio%20Server">RStudio Server</a> rather than connecting from the terminal.</li>
</ul>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-43"></span>
<div id="htmlwidget-f98305418b614f8941a3" style="width:100%;height:140pt;" class="r2d3 html-widget"></div>
<script type="application/json" data-for="htmlwidget-f98305418b614f8941a3">{"x":{"data":null,"type":"NULL","container":"svg","options":null,"script":"var d3Script = function(d3, r2d3, data, svg, width, height, options, theme, console) {\nthis.d3 = d3;\n/* R2D3 Source File:  images/06-connections-diagram.js */\n\nsvg.append(\"svg:defs\").append(\"svg:marker\")\n  .attr(\"id\", \"circle\")\n  .attr(\"refX\", 6)\n  .attr(\"refY\", 6)\n  .attr(\"markerWidth\", 12)\n  .attr(\"markerHeight\", 12)\n  .attr(\"orient\", \"auto\")\n  .append(\"circle\")\n  .attr(\"cx\", \"6\")\n  .attr(\"cy\", \"6\")\n  .attr(\"r\", \"3\")\n  .attr(\"class\", \"block-link\")\n  .attr(\"stroke-width\", 1);\n\nfunction diagramRoot(maxWidth) {\n  if (!maxWidth) maxWidth = 500;\n\n  var scaleX = 1;\n  var scaleY = 1;\n  height = height - 20;\n\n  var newWidth = width > maxWidth ? maxWidth : width;\n  var translateX = width > newWidth ? (width - newWidth) / 2 : 0;\n  var translateY = 10;\n  width = newWidth;\n\n  svg\n    .attr(\"font-size\", Math.min(width, 500) / 600 + \"em\")\n    .attr(\"font-family\", \"sans-serif\");\n\n  var root = svg.append(\"g\")\n    .attr(\"transform\", \"translate(\" + translateX + \",\" + translateY + \")scale(\" + scaleX + \",\" + scaleY + \")\");\n\n  return root;\n}\n\nfunction drawBlock(parent, block) {\n  if (!block.x) block.x = 0;\n  if (!block.y) block.y = 0;\n  if (!block.width) block.width = blockWidth;\n  if (!block.height) block.height = blockHeight;\n  if (!block.color) block.color = \"#bbcce0\";\n  if (!block.label) block.label = \"<label>\";\n  if (!block.style) block.style = \"block\";\n\n  var startX = block.x - block.width / 2;\n  var startY = block.y - block.height / 2;\n\n  parent.append(\"rect\")\n    .attr(\"x\", startX)\n    .attr(\"y\", startY)\n    .attr(\"width\", block.width)\n    .attr(\"height\", block.height)\n    .attr(\"class\", block.style);\n\n  var current = parent.append(\"text\")\n    .attr(\"x\", block.x)\n    .attr(\"y\", startY + 20)\n    .attr(\"fill\", \"white\")\n    .attr(\"text-anchor\", \"middle\")\n    .text(block.label);\n\n  if (block.childrens) {\n    for (var childIdx in block.childrens) {\n      var child = block.childrens[childIdx];\n\n      if (!child.width) child.width = block.width - 20;\n      if (!child.x) child.x = block.x;\n      if (child.position === undefined) child.position = childIdx;\n      if (child.style === undefined) child.style = \"block-children\";\n\n      var childBlock = {\n        x: child.x,\n        y: startY + 46 + child.position * 34,\n        width: child.width,\n        height: 30,\n        label: child.label,\n        style: child.style\n      };\n\n      drawBlock(parent, childBlock);\n    }\n  }\n\n  return block;\n}\n\nfunction linkBlocks(block1, block2, label) {\n  var block1right = block1.x + block1.width / 2;\n  var block2left = block2.x - block2.width / 2;\n  var block1bottom = block1.y + block1.height / 2;\n  var block2top = block2.y - block2.height / 2;\n\n  var horizontal = block1right < block2left;\n\n  root.append('line')\n    .attr(\"x1\", horizontal ? block1right : block1.x)\n    .attr(\"y1\", horizontal ? block1.y : block1bottom)\n    .attr(\"x2\", horizontal ? block2left : block2.x)\n    .attr(\"y2\", horizontal ? block2.y : block2top)\n  \t.attr(\"class\", \"block-link\")\n  \t.attr(\"stroke-width\", \"1\")\n  \t.attr(\"marker-start\", \"url(#circle)\")\n  \t.attr(\"marker-end\", \"url(#circle)\")\n  \t.attr(\"stroke-dasharray\", \"3,7\");\n\n  var labelFits = horizontal ?\n    Math.abs(block2left - block1right) > block1.width / 2 :\n    Math.abs(block2top - block1bottom) > 30;\n\n  if (label && labelFits) {\n    root.append('text')\n      .attr(\"dy\", (horizontal ? \"-\" : \"\") + \"0.4em\")\n      .attr(\"x\", block1right + (block2left - block1right) / 2)\n      .attr(\"y\", block1bottom + (block2top - block1bottom) / 2)\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"fill\", \"#759cc7\")\n      .text(label);\n  }\n}\nsvg = d3.select(svg.node());\n/* R2D3 Source File:  images/06-connections-cluster-clients.js */\n// !preview r2d3 dependencies=\"images/06-connections-diagram.js\", css=\"images/06-connections-diagram.css\"\n//\n// r2d3: https://rstudio.github.io/r2d3\n//\n\nvar root = diagramRoot();\nvar blockWidth = width / 3.0;\n\nvar blockHeight = height - 10;\n\nvar driverBlock = drawBlock(root, {\n  x: blockWidth / 2,\n  y: height / 2,\n  height: blockHeight,\n  label: \"Client\",\n  childrens: [{\n    label: \"Terminal\"\n  }, {\n    label: \"Web Borwser\"\n  }]\n});\n\nvar edgeBlock = drawBlock(root, {\n  x: width - blockWidth / 2,\n  y: height / 2,\n  height: blockHeight,\n  label: \"Edge\",\n  childrens: [{\n    label: \"Secure Shell Server\"\n  }, {\n    label: \"Web Server\"\n  }, {\n    label: \"RStudio Server\"\n  }]\n});\n\nlinkBlocks(driverBlock, edgeBlock, \"Secure Shell / HTTP\");\n};","style":"/* R2D3 Source File:  images/06-connections-diagram.css */\n.block {\n  fill: #bbcce0;\n}\n\n.block-children {\n  fill:  #93acc7;\n}\n\n.block-link {\n  fill: white;\n  stroke: #bbcce0;\n}","version":5,"theme":{"default":{"background":"#FFFFFF","foreground":"#000000"},"runtime":null},"useShadow":true},"evals":[],"jsHooks":[]}</script>
<p class="caption">
FIGURE 6.2: Using a Spark Cluster from an Edge Node
</p>
</div>
</div>
<div id="spark-home" class="section level3">
<h3><span class="header-section-number">6.1.2</span> Spark Home</h3>
<p>It is important to mention that, while connecting to a Spark cluster, you will need to find out the correct <code>SPARK_HOME</code> path which contains the installation of Spark in the given instance. The <code>SPARK_HOME</code> path must be set as an environment variable before connecting or explicitly specified in <code>spark_connect()</code> using the <code>spark_home</code> parameter.</p>
<p>For system administrators, we recommend you set <code>SPARK_HOME</code> for all the users in your cluster; however, if this is not set in your cluster you can also specify <code>SPARK_HOME</code> while using <code>spark_connect()</code> as follows:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1">sc &lt;-<span class="st"> </span><span class="kw">spark_connect</span>(<span class="dt">master =</span> <span class="st">&quot;cluster-master&quot;</span>, <span class="dt">spark_home =</span> <span class="st">&quot;local/path/to/spark&quot;</span>)</a></code></pre></div>
<p>Where <code>cluster-master</code> is set to the correct cluster manager master for <a href="Standalone">Spark Standalone</a>, <a href="Yarn">YARN</a>, <a href="connections.html#mesos-1">Mesos</a>, etc.</p>
</div>
</div>
<div id="types" class="section level2">
<h2><span class="header-section-number">6.2</span> Types</h2>
<div id="connection-local" class="section level3">
<h3><span class="header-section-number">6.2.1</span> Local</h3>
<p>When connecting to Spark in local mode, Spark starts as a single application simulating a cluster with a single node, this is not a proper computing cluster but is ideal to perform work offline and troubleshoot issues. A local connection to Spark is represented in the following diagram:</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-45"></span>
<div id="htmlwidget-f84169a96020e52f6220" style="width:100%;height:160pt;" class="r2d3 html-widget"></div>
<script type="application/json" data-for="htmlwidget-f84169a96020e52f6220">{"x":{"data":null,"type":"NULL","container":"svg","options":null,"script":"var d3Script = function(d3, r2d3, data, svg, width, height, options, theme, console) {\nthis.d3 = d3;\n/* R2D3 Source File:  images/06-connections-diagram.js */\n\nsvg.append(\"svg:defs\").append(\"svg:marker\")\n  .attr(\"id\", \"circle\")\n  .attr(\"refX\", 6)\n  .attr(\"refY\", 6)\n  .attr(\"markerWidth\", 12)\n  .attr(\"markerHeight\", 12)\n  .attr(\"orient\", \"auto\")\n  .append(\"circle\")\n  .attr(\"cx\", \"6\")\n  .attr(\"cy\", \"6\")\n  .attr(\"r\", \"3\")\n  .attr(\"class\", \"block-link\")\n  .attr(\"stroke-width\", 1);\n\nfunction diagramRoot(maxWidth) {\n  if (!maxWidth) maxWidth = 500;\n\n  var scaleX = 1;\n  var scaleY = 1;\n  height = height - 20;\n\n  var newWidth = width > maxWidth ? maxWidth : width;\n  var translateX = width > newWidth ? (width - newWidth) / 2 : 0;\n  var translateY = 10;\n  width = newWidth;\n\n  svg\n    .attr(\"font-size\", Math.min(width, 500) / 600 + \"em\")\n    .attr(\"font-family\", \"sans-serif\");\n\n  var root = svg.append(\"g\")\n    .attr(\"transform\", \"translate(\" + translateX + \",\" + translateY + \")scale(\" + scaleX + \",\" + scaleY + \")\");\n\n  return root;\n}\n\nfunction drawBlock(parent, block) {\n  if (!block.x) block.x = 0;\n  if (!block.y) block.y = 0;\n  if (!block.width) block.width = blockWidth;\n  if (!block.height) block.height = blockHeight;\n  if (!block.color) block.color = \"#bbcce0\";\n  if (!block.label) block.label = \"<label>\";\n  if (!block.style) block.style = \"block\";\n\n  var startX = block.x - block.width / 2;\n  var startY = block.y - block.height / 2;\n\n  parent.append(\"rect\")\n    .attr(\"x\", startX)\n    .attr(\"y\", startY)\n    .attr(\"width\", block.width)\n    .attr(\"height\", block.height)\n    .attr(\"class\", block.style);\n\n  var current = parent.append(\"text\")\n    .attr(\"x\", block.x)\n    .attr(\"y\", startY + 20)\n    .attr(\"fill\", \"white\")\n    .attr(\"text-anchor\", \"middle\")\n    .text(block.label);\n\n  if (block.childrens) {\n    for (var childIdx in block.childrens) {\n      var child = block.childrens[childIdx];\n\n      if (!child.width) child.width = block.width - 20;\n      if (!child.x) child.x = block.x;\n      if (child.position === undefined) child.position = childIdx;\n      if (child.style === undefined) child.style = \"block-children\";\n\n      var childBlock = {\n        x: child.x,\n        y: startY + 46 + child.position * 34,\n        width: child.width,\n        height: 30,\n        label: child.label,\n        style: child.style\n      };\n\n      drawBlock(parent, childBlock);\n    }\n  }\n\n  return block;\n}\n\nfunction linkBlocks(block1, block2, label) {\n  var block1right = block1.x + block1.width / 2;\n  var block2left = block2.x - block2.width / 2;\n  var block1bottom = block1.y + block1.height / 2;\n  var block2top = block2.y - block2.height / 2;\n\n  var horizontal = block1right < block2left;\n\n  root.append('line')\n    .attr(\"x1\", horizontal ? block1right : block1.x)\n    .attr(\"y1\", horizontal ? block1.y : block1bottom)\n    .attr(\"x2\", horizontal ? block2left : block2.x)\n    .attr(\"y2\", horizontal ? block2.y : block2top)\n  \t.attr(\"class\", \"block-link\")\n  \t.attr(\"stroke-width\", \"1\")\n  \t.attr(\"marker-start\", \"url(#circle)\")\n  \t.attr(\"marker-end\", \"url(#circle)\")\n  \t.attr(\"stroke-dasharray\", \"3,7\");\n\n  var labelFits = horizontal ?\n    Math.abs(block2left - block1right) > block1.width / 2 :\n    Math.abs(block2top - block1bottom) > 30;\n\n  if (label && labelFits) {\n    root.append('text')\n      .attr(\"dy\", (horizontal ? \"-\" : \"\") + \"0.4em\")\n      .attr(\"x\", block1right + (block2left - block1right) / 2)\n      .attr(\"y\", block1bottom + (block2top - block1bottom) / 2)\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"fill\", \"#759cc7\")\n      .text(label);\n  }\n}\nsvg = d3.select(svg.node());\n/* R2D3 Source File:  images/06-connections-local.js */\n// !preview r2d3 dependencies=\"images/06-connections-diagram.js\", css=\"images/06-connections-diagram.css\"\n//\n// r2d3: https://rstudio.github.io/r2d3\n//\n\nvar root = diagramRoot();\nvar blockWidth = width / 3.5;\nvar blockHeight = Math.min(140, height * 0.8);\n\nvar driverBlock = drawBlock(root, {\n  x: width / 2,\n  y: height / 2,\n  height: height,\n  label: \"Driver\",\n  childrens: [{\n    label: \"R\"\n  }, {\n    label: \"sparklyr\"\n  }, {\n    label: \"Spark Context\"\n  }, {\n    label: \"Spark Executor\"\n  }]\n});\n\n};","style":"/* R2D3 Source File:  images/06-connections-diagram.css */\n.block {\n  fill: #bbcce0;\n}\n\n.block-children {\n  fill:  #93acc7;\n}\n\n.block-link {\n  fill: white;\n  stroke: #bbcce0;\n}","version":5,"theme":{"default":{"background":"#FFFFFF","foreground":"#000000"},"runtime":null},"useShadow":true},"evals":[],"jsHooks":[]}</script>
<p class="caption">
FIGURE 6.3: Local Connection Diagram
</p>
</div>
<p>Notice that in the local connections diagram, there is no cluster manager nor worker process since, in local mode, everything runs inside the driver application. It’s also worth pointing out that <code>sparklyr</code> starts the Spark Context through <code>spark-submit</code>, a script available in every Spark installation to enable users to submit custom application to Spark which <code>sparklyr</code> makes use of to submit itself to Spark. For the curious reader, the <a href="contributing.html#contributing">Contributing</a> chapter explains the internal processes that take place in <code>sparklyr</code> to submit this application and connect properly from R.</p>
<p>To perform this local connection, we can connect with the following familiar code used in previous chapters:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="co"># Connect to local Spark instance</span></a>
<a class="sourceLine" id="cb39-2" data-line-number="2">sc &lt;-<span class="st"> </span><span class="kw">spark_connect</span>(<span class="dt">master =</span> <span class="st">&quot;local&quot;</span>)</a></code></pre></div>
<p>By default, <code>sparklyr</code>, will connect using as many CPU cores are available in your compute instance; however, this can be customized by connecting using <code>master=&quot;local[n]&quot;</code>, where <code>n</code> is the desired number of cores to use. For example, we can connect using only 2 CPU cores as follows:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="co"># Connect to local Spark instance using 2 cores</span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2">sc &lt;-<span class="st"> </span><span class="kw">spark_connect</span>(<span class="dt">master =</span> <span class="st">&quot;local[2]&quot;</span>)</a></code></pre></div>
</div>
<div id="standalone" class="section level3">
<h3><span class="header-section-number">6.2.2</span> Standalone</h3>
<p>Connecting to a Spark Standalone cluster requires the location of the cluster manager’s master instance, this location can be found in the cluster manager web interface as described in the <a href="standalone%20cluster">clusters-standalone</a> section, you can find this location by looking for a URL starting with <code>spark://</code>.</p>
<p>A connection in standalone mode starts from <code>sparklyr</code> launching <code>spark-submit</code> to submit the <code>sparklyr</code> application and creating the Spark Context, which requests executors to Spark’s standalone cluster manager in the <code>master</code> location:</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-48"></span>
<div id="htmlwidget-37783a03b6fcc0a2274e" style="width:100%;height:480px;" class="r2d3 html-widget"></div>
<script type="application/json" data-for="htmlwidget-37783a03b6fcc0a2274e">{"x":{"data":null,"type":"NULL","container":"svg","options":null,"script":"var d3Script = function(d3, r2d3, data, svg, width, height, options, theme, console) {\nthis.d3 = d3;\n/* R2D3 Source File:  images/06-connections-diagram.js */\n\nsvg.append(\"svg:defs\").append(\"svg:marker\")\n  .attr(\"id\", \"circle\")\n  .attr(\"refX\", 6)\n  .attr(\"refY\", 6)\n  .attr(\"markerWidth\", 12)\n  .attr(\"markerHeight\", 12)\n  .attr(\"orient\", \"auto\")\n  .append(\"circle\")\n  .attr(\"cx\", \"6\")\n  .attr(\"cy\", \"6\")\n  .attr(\"r\", \"3\")\n  .attr(\"class\", \"block-link\")\n  .attr(\"stroke-width\", 1);\n\nfunction diagramRoot(maxWidth) {\n  if (!maxWidth) maxWidth = 500;\n\n  var scaleX = 1;\n  var scaleY = 1;\n  height = height - 20;\n\n  var newWidth = width > maxWidth ? maxWidth : width;\n  var translateX = width > newWidth ? (width - newWidth) / 2 : 0;\n  var translateY = 10;\n  width = newWidth;\n\n  svg\n    .attr(\"font-size\", Math.min(width, 500) / 600 + \"em\")\n    .attr(\"font-family\", \"sans-serif\");\n\n  var root = svg.append(\"g\")\n    .attr(\"transform\", \"translate(\" + translateX + \",\" + translateY + \")scale(\" + scaleX + \",\" + scaleY + \")\");\n\n  return root;\n}\n\nfunction drawBlock(parent, block) {\n  if (!block.x) block.x = 0;\n  if (!block.y) block.y = 0;\n  if (!block.width) block.width = blockWidth;\n  if (!block.height) block.height = blockHeight;\n  if (!block.color) block.color = \"#bbcce0\";\n  if (!block.label) block.label = \"<label>\";\n  if (!block.style) block.style = \"block\";\n\n  var startX = block.x - block.width / 2;\n  var startY = block.y - block.height / 2;\n\n  parent.append(\"rect\")\n    .attr(\"x\", startX)\n    .attr(\"y\", startY)\n    .attr(\"width\", block.width)\n    .attr(\"height\", block.height)\n    .attr(\"class\", block.style);\n\n  var current = parent.append(\"text\")\n    .attr(\"x\", block.x)\n    .attr(\"y\", startY + 20)\n    .attr(\"fill\", \"white\")\n    .attr(\"text-anchor\", \"middle\")\n    .text(block.label);\n\n  if (block.childrens) {\n    for (var childIdx in block.childrens) {\n      var child = block.childrens[childIdx];\n\n      if (!child.width) child.width = block.width - 20;\n      if (!child.x) child.x = block.x;\n      if (child.position === undefined) child.position = childIdx;\n      if (child.style === undefined) child.style = \"block-children\";\n\n      var childBlock = {\n        x: child.x,\n        y: startY + 46 + child.position * 34,\n        width: child.width,\n        height: 30,\n        label: child.label,\n        style: child.style\n      };\n\n      drawBlock(parent, childBlock);\n    }\n  }\n\n  return block;\n}\n\nfunction linkBlocks(block1, block2, label) {\n  var block1right = block1.x + block1.width / 2;\n  var block2left = block2.x - block2.width / 2;\n  var block1bottom = block1.y + block1.height / 2;\n  var block2top = block2.y - block2.height / 2;\n\n  var horizontal = block1right < block2left;\n\n  root.append('line')\n    .attr(\"x1\", horizontal ? block1right : block1.x)\n    .attr(\"y1\", horizontal ? block1.y : block1bottom)\n    .attr(\"x2\", horizontal ? block2left : block2.x)\n    .attr(\"y2\", horizontal ? block2.y : block2top)\n  \t.attr(\"class\", \"block-link\")\n  \t.attr(\"stroke-width\", \"1\")\n  \t.attr(\"marker-start\", \"url(#circle)\")\n  \t.attr(\"marker-end\", \"url(#circle)\")\n  \t.attr(\"stroke-dasharray\", \"3,7\");\n\n  var labelFits = horizontal ?\n    Math.abs(block2left - block1right) > block1.width / 2 :\n    Math.abs(block2top - block1bottom) > 30;\n\n  if (label && labelFits) {\n    root.append('text')\n      .attr(\"dy\", (horizontal ? \"-\" : \"\") + \"0.4em\")\n      .attr(\"x\", block1right + (block2left - block1right) / 2)\n      .attr(\"y\", block1bottom + (block2top - block1bottom) / 2)\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"fill\", \"#759cc7\")\n      .text(label);\n  }\n}\nsvg = d3.select(svg.node());\n/* R2D3 Source File:  images/06-connections-standalone.js */\n// !preview r2d3 dependencies=\"images/06-connections-diagram.js\", css=\"images/06-connections-diagram.css\"\n//\n// r2d3: https://rstudio.github.io/r2d3\n//\n\nvar root = diagramRoot(600);\nvar blockWidth = width / 4.0;\n\nvar totalWorkers = 3;\nvar blockHeight = height / totalWorkers - 10;\n\nvar driverBlock = drawBlock(root, {\n  x: blockWidth / 2,\n  y: height / 2,\n  height: 150,\n  label: \"Driver\",\n  childrens: [{\n    label: \"R\"\n  }, {\n    label: \"sparklyr\"\n  }, {\n    label: \"Spark Context\"\n  }]\n});\n\nvar clusterBlock = drawBlock(root, {\n  x: width / 2,\n  y: height / 2,\n  height: 80,\n  label: \"Cluster Manager\",\n  childrens: [{\n    label: \"Spark Standalone\"\n  }]\n});\n\nvar workers = new Array(totalWorkers);\nfor (var i = 0; i < totalWorkers; i++) {\n  workers[i] = drawBlock(root, {\n    x: width - blockWidth / 2,\n    y: 5 + blockHeight / 2 + height / totalWorkers * i,\n    height: blockHeight,\n    label: \"Worker\",\n    childrens: [{\n      label: \"Spark Executor\",\n      color: \"#759cc7\"\n    }, {\n      label: \"Spark Executor\",\n      color: \"#759cc7\"\n    }]\n  });\n}\n\nlinkBlocks(driverBlock, clusterBlock);\nfor (var i = 0; i < workers.length; i++) {\n  linkBlocks(clusterBlock, workers[i]);\n}\n};","style":"/* R2D3 Source File:  images/06-connections-diagram.css */\n.block {\n  fill: #bbcce0;\n}\n\n.block-children {\n  fill:  #93acc7;\n}\n\n.block-link {\n  fill: white;\n  stroke: #bbcce0;\n}","version":5,"theme":{"default":{"background":"#FFFFFF","foreground":"#000000"},"runtime":null},"useShadow":true},"evals":[],"jsHooks":[]}</script>
<p class="caption">
FIGURE 6.4: Spark Standalone Connection Diagram
</p>
</div>
<p>In order to connect, use <code>master=&quot;spark://hostname:port&quot;</code> in <code>spark_connect()</code> as follows:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1">sc &lt;-<span class="st"> </span><span class="kw">spark_connect</span>(<span class="dt">master =</span> <span class="st">&quot;spark://hostname:port&quot;</span>)</a></code></pre></div>
</div>
<div id="yarn-1" class="section level3">
<h3><span class="header-section-number">6.2.3</span> Yarn</h3>
<p>Hadoop YARN supports two connection modes: YARN Client and YARN Cluster. However, YARN Client mode is much more common that YARN Cluster since it’s more efficient and easier to set up.</p>
<div id="yarn-client" class="section level4">
<h4><span class="header-section-number">6.2.3.1</span> Yarn Client</h4>
<p>When connecting in YARN Client mode, the driver instance runs R, sparklyr and the Spark Context which requests worker nodes from YARN to run Spark executors as follows:</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-50"></span>
<div id="htmlwidget-b511b47d313a5681959c" style="width:100%;height:480px;" class="r2d3 html-widget"></div>
<script type="application/json" data-for="htmlwidget-b511b47d313a5681959c">{"x":{"data":null,"type":"NULL","container":"svg","options":null,"script":"var d3Script = function(d3, r2d3, data, svg, width, height, options, theme, console) {\nthis.d3 = d3;\n/* R2D3 Source File:  images/06-connections-diagram.js */\n\nsvg.append(\"svg:defs\").append(\"svg:marker\")\n  .attr(\"id\", \"circle\")\n  .attr(\"refX\", 6)\n  .attr(\"refY\", 6)\n  .attr(\"markerWidth\", 12)\n  .attr(\"markerHeight\", 12)\n  .attr(\"orient\", \"auto\")\n  .append(\"circle\")\n  .attr(\"cx\", \"6\")\n  .attr(\"cy\", \"6\")\n  .attr(\"r\", \"3\")\n  .attr(\"class\", \"block-link\")\n  .attr(\"stroke-width\", 1);\n\nfunction diagramRoot(maxWidth) {\n  if (!maxWidth) maxWidth = 500;\n\n  var scaleX = 1;\n  var scaleY = 1;\n  height = height - 20;\n\n  var newWidth = width > maxWidth ? maxWidth : width;\n  var translateX = width > newWidth ? (width - newWidth) / 2 : 0;\n  var translateY = 10;\n  width = newWidth;\n\n  svg\n    .attr(\"font-size\", Math.min(width, 500) / 600 + \"em\")\n    .attr(\"font-family\", \"sans-serif\");\n\n  var root = svg.append(\"g\")\n    .attr(\"transform\", \"translate(\" + translateX + \",\" + translateY + \")scale(\" + scaleX + \",\" + scaleY + \")\");\n\n  return root;\n}\n\nfunction drawBlock(parent, block) {\n  if (!block.x) block.x = 0;\n  if (!block.y) block.y = 0;\n  if (!block.width) block.width = blockWidth;\n  if (!block.height) block.height = blockHeight;\n  if (!block.color) block.color = \"#bbcce0\";\n  if (!block.label) block.label = \"<label>\";\n  if (!block.style) block.style = \"block\";\n\n  var startX = block.x - block.width / 2;\n  var startY = block.y - block.height / 2;\n\n  parent.append(\"rect\")\n    .attr(\"x\", startX)\n    .attr(\"y\", startY)\n    .attr(\"width\", block.width)\n    .attr(\"height\", block.height)\n    .attr(\"class\", block.style);\n\n  var current = parent.append(\"text\")\n    .attr(\"x\", block.x)\n    .attr(\"y\", startY + 20)\n    .attr(\"fill\", \"white\")\n    .attr(\"text-anchor\", \"middle\")\n    .text(block.label);\n\n  if (block.childrens) {\n    for (var childIdx in block.childrens) {\n      var child = block.childrens[childIdx];\n\n      if (!child.width) child.width = block.width - 20;\n      if (!child.x) child.x = block.x;\n      if (child.position === undefined) child.position = childIdx;\n      if (child.style === undefined) child.style = \"block-children\";\n\n      var childBlock = {\n        x: child.x,\n        y: startY + 46 + child.position * 34,\n        width: child.width,\n        height: 30,\n        label: child.label,\n        style: child.style\n      };\n\n      drawBlock(parent, childBlock);\n    }\n  }\n\n  return block;\n}\n\nfunction linkBlocks(block1, block2, label) {\n  var block1right = block1.x + block1.width / 2;\n  var block2left = block2.x - block2.width / 2;\n  var block1bottom = block1.y + block1.height / 2;\n  var block2top = block2.y - block2.height / 2;\n\n  var horizontal = block1right < block2left;\n\n  root.append('line')\n    .attr(\"x1\", horizontal ? block1right : block1.x)\n    .attr(\"y1\", horizontal ? block1.y : block1bottom)\n    .attr(\"x2\", horizontal ? block2left : block2.x)\n    .attr(\"y2\", horizontal ? block2.y : block2top)\n  \t.attr(\"class\", \"block-link\")\n  \t.attr(\"stroke-width\", \"1\")\n  \t.attr(\"marker-start\", \"url(#circle)\")\n  \t.attr(\"marker-end\", \"url(#circle)\")\n  \t.attr(\"stroke-dasharray\", \"3,7\");\n\n  var labelFits = horizontal ?\n    Math.abs(block2left - block1right) > block1.width / 2 :\n    Math.abs(block2top - block1bottom) > 30;\n\n  if (label && labelFits) {\n    root.append('text')\n      .attr(\"dy\", (horizontal ? \"-\" : \"\") + \"0.4em\")\n      .attr(\"x\", block1right + (block2left - block1right) / 2)\n      .attr(\"y\", block1bottom + (block2top - block1bottom) / 2)\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"fill\", \"#759cc7\")\n      .text(label);\n  }\n}\nsvg = d3.select(svg.node());\n/* R2D3 Source File:  images/06-connections-yarn-client.js */\n// !preview r2d3 dependencies=\"images/06-connections-diagram.js\", css=\"images/06-connections-diagram.css\"\n//\n// r2d3: https://rstudio.github.io/r2d3\n//\n\nvar root = diagramRoot(600);\nvar blockWidth = width / 4.0;\n\nvar totalWorkers = 3;\nvar blockHeight = height / totalWorkers - 10;\n\nvar driverBlock = drawBlock(root, {\n  x: blockWidth / 2,\n  y: height / 2,\n  height: 150,\n  label: \"Driver\",\n  childrens: [{\n    label: \"R\"\n  }, {\n    label: \"sparklyr\"\n  }, {\n    label: \"Spark Context\"\n  }]\n});\n\nvar clusterBlock = drawBlock(root, {\n  x: width / 2,\n  y: height / 2,\n  height: 80,\n  label: \"Cluster Manager\",\n  childrens: [{\n    label: \"YARN\"\n  }]\n});\n\nvar workers = new Array(totalWorkers);\nfor (var i = 0; i < totalWorkers; i++) {\n  workers[i] = drawBlock(root, {\n    x: width - blockWidth / 2,\n    y: 5 + blockHeight / 2 + height / totalWorkers * i,\n    height: blockHeight,\n    label: \"Worker\",\n    childrens: [{\n      label: \"Spark Executor\",\n      color: \"#759cc7\"\n    }, {\n      label: \"Spark Executor\",\n      color: \"#759cc7\"\n    }]\n  });\n}\n\nlinkBlocks(driverBlock, clusterBlock);\nfor (var i = 0; i < workers.length; i++) {\n  linkBlocks(clusterBlock, workers[i]);\n}\n};","style":"/* R2D3 Source File:  images/06-connections-diagram.css */\n.block {\n  fill: #bbcce0;\n}\n\n.block-children {\n  fill:  #93acc7;\n}\n\n.block-link {\n  fill: white;\n  stroke: #bbcce0;\n}","version":5,"theme":{"default":{"background":"#FFFFFF","foreground":"#000000"},"runtime":null},"useShadow":true},"evals":[],"jsHooks":[]}</script>
<p class="caption">
FIGURE 6.5: YARN Client Connection Diagram
</p>
</div>
<p>To connect, one can simply run with <code>master = &quot;yarn&quot;</code> as follows:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1">sc &lt;-<span class="st"> </span><span class="kw">spark_connect</span>(<span class="dt">master =</span> <span class="st">&quot;yarn-client&quot;</span>)</a></code></pre></div>
<p>Once connected, you can use all techniques described in previous chapters using the <code>sc</code> connection; for instances, you can do <a href="analysis">data analysis</a> or <a href="modeling.html#modeling">modeling</a>.</p>
</div>
<div id="yarn-cluster" class="section level4">
<h4><span class="header-section-number">6.2.3.2</span> Yarn Cluster</h4>
<p>The main difference between YARN Cluster mode and YARN Client mode is that in YARN Cluster mode, the driver node is not required to be the node where R and sparklyr get started; instead, the driver node remains the designated driver node which is usually a different node than the edge node where R is running. It can be helpful to consider using YARN Cluster when the edge node has too many concurrent users, is lacking computing resources or where tools (like RStudio) need to be managed independently of other clsuter resources.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-52"></span>
<div id="htmlwidget-a7726bf2a4b47fa31519" style="width:100%;height:480px;" class="r2d3 html-widget"></div>
<script type="application/json" data-for="htmlwidget-a7726bf2a4b47fa31519">{"x":{"data":null,"type":"NULL","container":"svg","options":null,"script":"var d3Script = function(d3, r2d3, data, svg, width, height, options, theme, console) {\nthis.d3 = d3;\n/* R2D3 Source File:  images/06-connections-diagram.js */\n\nsvg.append(\"svg:defs\").append(\"svg:marker\")\n  .attr(\"id\", \"circle\")\n  .attr(\"refX\", 6)\n  .attr(\"refY\", 6)\n  .attr(\"markerWidth\", 12)\n  .attr(\"markerHeight\", 12)\n  .attr(\"orient\", \"auto\")\n  .append(\"circle\")\n  .attr(\"cx\", \"6\")\n  .attr(\"cy\", \"6\")\n  .attr(\"r\", \"3\")\n  .attr(\"class\", \"block-link\")\n  .attr(\"stroke-width\", 1);\n\nfunction diagramRoot(maxWidth) {\n  if (!maxWidth) maxWidth = 500;\n\n  var scaleX = 1;\n  var scaleY = 1;\n  height = height - 20;\n\n  var newWidth = width > maxWidth ? maxWidth : width;\n  var translateX = width > newWidth ? (width - newWidth) / 2 : 0;\n  var translateY = 10;\n  width = newWidth;\n\n  svg\n    .attr(\"font-size\", Math.min(width, 500) / 600 + \"em\")\n    .attr(\"font-family\", \"sans-serif\");\n\n  var root = svg.append(\"g\")\n    .attr(\"transform\", \"translate(\" + translateX + \",\" + translateY + \")scale(\" + scaleX + \",\" + scaleY + \")\");\n\n  return root;\n}\n\nfunction drawBlock(parent, block) {\n  if (!block.x) block.x = 0;\n  if (!block.y) block.y = 0;\n  if (!block.width) block.width = blockWidth;\n  if (!block.height) block.height = blockHeight;\n  if (!block.color) block.color = \"#bbcce0\";\n  if (!block.label) block.label = \"<label>\";\n  if (!block.style) block.style = \"block\";\n\n  var startX = block.x - block.width / 2;\n  var startY = block.y - block.height / 2;\n\n  parent.append(\"rect\")\n    .attr(\"x\", startX)\n    .attr(\"y\", startY)\n    .attr(\"width\", block.width)\n    .attr(\"height\", block.height)\n    .attr(\"class\", block.style);\n\n  var current = parent.append(\"text\")\n    .attr(\"x\", block.x)\n    .attr(\"y\", startY + 20)\n    .attr(\"fill\", \"white\")\n    .attr(\"text-anchor\", \"middle\")\n    .text(block.label);\n\n  if (block.childrens) {\n    for (var childIdx in block.childrens) {\n      var child = block.childrens[childIdx];\n\n      if (!child.width) child.width = block.width - 20;\n      if (!child.x) child.x = block.x;\n      if (child.position === undefined) child.position = childIdx;\n      if (child.style === undefined) child.style = \"block-children\";\n\n      var childBlock = {\n        x: child.x,\n        y: startY + 46 + child.position * 34,\n        width: child.width,\n        height: 30,\n        label: child.label,\n        style: child.style\n      };\n\n      drawBlock(parent, childBlock);\n    }\n  }\n\n  return block;\n}\n\nfunction linkBlocks(block1, block2, label) {\n  var block1right = block1.x + block1.width / 2;\n  var block2left = block2.x - block2.width / 2;\n  var block1bottom = block1.y + block1.height / 2;\n  var block2top = block2.y - block2.height / 2;\n\n  var horizontal = block1right < block2left;\n\n  root.append('line')\n    .attr(\"x1\", horizontal ? block1right : block1.x)\n    .attr(\"y1\", horizontal ? block1.y : block1bottom)\n    .attr(\"x2\", horizontal ? block2left : block2.x)\n    .attr(\"y2\", horizontal ? block2.y : block2top)\n  \t.attr(\"class\", \"block-link\")\n  \t.attr(\"stroke-width\", \"1\")\n  \t.attr(\"marker-start\", \"url(#circle)\")\n  \t.attr(\"marker-end\", \"url(#circle)\")\n  \t.attr(\"stroke-dasharray\", \"3,7\");\n\n  var labelFits = horizontal ?\n    Math.abs(block2left - block1right) > block1.width / 2 :\n    Math.abs(block2top - block1bottom) > 30;\n\n  if (label && labelFits) {\n    root.append('text')\n      .attr(\"dy\", (horizontal ? \"-\" : \"\") + \"0.4em\")\n      .attr(\"x\", block1right + (block2left - block1right) / 2)\n      .attr(\"y\", block1bottom + (block2top - block1bottom) / 2)\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"fill\", \"#759cc7\")\n      .text(label);\n  }\n}\nsvg = d3.select(svg.node());\n/* R2D3 Source File:  images/06-connections-yarn-cluster.js */\n// !preview r2d3 dependencies=\"images/06-connections-diagram.js\", css=\"images/06-connections-diagram.css\"\n//\n// r2d3: https://rstudio.github.io/r2d3\n//\n\nvar root = diagramRoot(600);\nvar blockWidth = width / 4.0;\n\nvar totalWorkers = 3;\nvar blockHeight = height / totalWorkers - 10;\n\nvar sparklyrBlock = drawBlock(root, {\n  x: blockWidth / 2,\n  y: blockHeight / 3,\n  height: height / 4,\n  label: \"R\",\n  childrens: [{\n    label: \"sparklyr\"\n  }]\n});\n\nvar driverBlock = drawBlock(root, {\n  x: blockWidth / 2,\n  y: height / 2,\n  height: height / 4,\n  label: \"Driver\",\n  childrens: [{\n    label: \"Spark Context\"\n  }]\n});\n\nvar clusterBlock = drawBlock(root, {\n  x: width / 2,\n  y: height / 2,\n  height: 80,\n  label: \"Cluster Manager\",\n  childrens: [{\n    label: \"YARN\"\n  }]\n});\n\nlinkBlocks(sparklyrBlock, clusterBlock);\nlinkBlocks(driverBlock, clusterBlock);\n\nvar workers = new Array(totalWorkers);\nfor (var i = 0; i < totalWorkers; i++) {\n  workers[i] = drawBlock(root, {\n    x: width - blockWidth / 2,\n    y: 5 + blockHeight / 2 + height / totalWorkers * i,\n    height: blockHeight,\n    label: \"Worker\",\n    childrens: [{\n      label: \"Spark Executor\",\n      color: \"#759cc7\"\n    }, {\n      label: \"Spark Executor\",\n      color: \"#759cc7\"\n    }]\n  });\n}\n\nfor (var i = 0; i < workers.length; i++) {\n  linkBlocks(clusterBlock, workers[i]);\n}\n};","style":"/* R2D3 Source File:  images/06-connections-diagram.css */\n.block {\n  fill: #bbcce0;\n}\n\n.block-children {\n  fill:  #93acc7;\n}\n\n.block-link {\n  fill: white;\n  stroke: #bbcce0;\n}","version":5,"theme":{"default":{"background":"#FFFFFF","foreground":"#000000"},"runtime":null},"useShadow":true},"evals":[],"jsHooks":[]}</script>
<p class="caption">
FIGURE 6.6: YARN Cluster Connection Diagram
</p>
</div>
<p>To connect in YARN Cluster mode, we can simple run:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1">sc &lt;-<span class="st"> </span><span class="kw">spark_connect</span>(<span class="dt">master =</span> <span class="st">&quot;yarn-cluster&quot;</span>)</a></code></pre></div>
<p>This connection assumes that the node running <code>spark_connect()</code> is properly configured, meaning that, <code>yarn-site.xml</code> exists and the <code>YARN_CONF_DIR</code> environment variable is properly set. When using Hadoop as a file system, one would also need the <code>HADOOP_CONF_DIR</code> environment variable properly configured. This configuration is usually provided by your system administrator and is not something that you would have to manually configure.</p>
</div>
</div>
<div id="livy" class="section level3">
<h3><span class="header-section-number">6.2.4</span> Livy</h3>
<p>As opposed to other connection methods which require using an edge node in the cluster, <a href="clusters-livy">Livy</a> Livy provides a <strong>Web API</strong> that makes the Spark cluster accessible from outside the cluster and neither requires a local installation in the client. Once connected through the Web API, the <strong>Livy Service</strong> starts the Spark context by requesting reosurces from the cluster manager and distributing work as usual.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-54"></span>
<div id="htmlwidget-7e75973177eda0896783" style="width:100%;height:480px;" class="r2d3 html-widget"></div>
<script type="application/json" data-for="htmlwidget-7e75973177eda0896783">{"x":{"data":null,"type":"NULL","container":"svg","options":null,"script":"var d3Script = function(d3, r2d3, data, svg, width, height, options, theme, console) {\nthis.d3 = d3;\n/* R2D3 Source File:  images/06-connections-diagram.js */\n\nsvg.append(\"svg:defs\").append(\"svg:marker\")\n  .attr(\"id\", \"circle\")\n  .attr(\"refX\", 6)\n  .attr(\"refY\", 6)\n  .attr(\"markerWidth\", 12)\n  .attr(\"markerHeight\", 12)\n  .attr(\"orient\", \"auto\")\n  .append(\"circle\")\n  .attr(\"cx\", \"6\")\n  .attr(\"cy\", \"6\")\n  .attr(\"r\", \"3\")\n  .attr(\"class\", \"block-link\")\n  .attr(\"stroke-width\", 1);\n\nfunction diagramRoot(maxWidth) {\n  if (!maxWidth) maxWidth = 500;\n\n  var scaleX = 1;\n  var scaleY = 1;\n  height = height - 20;\n\n  var newWidth = width > maxWidth ? maxWidth : width;\n  var translateX = width > newWidth ? (width - newWidth) / 2 : 0;\n  var translateY = 10;\n  width = newWidth;\n\n  svg\n    .attr(\"font-size\", Math.min(width, 500) / 600 + \"em\")\n    .attr(\"font-family\", \"sans-serif\");\n\n  var root = svg.append(\"g\")\n    .attr(\"transform\", \"translate(\" + translateX + \",\" + translateY + \")scale(\" + scaleX + \",\" + scaleY + \")\");\n\n  return root;\n}\n\nfunction drawBlock(parent, block) {\n  if (!block.x) block.x = 0;\n  if (!block.y) block.y = 0;\n  if (!block.width) block.width = blockWidth;\n  if (!block.height) block.height = blockHeight;\n  if (!block.color) block.color = \"#bbcce0\";\n  if (!block.label) block.label = \"<label>\";\n  if (!block.style) block.style = \"block\";\n\n  var startX = block.x - block.width / 2;\n  var startY = block.y - block.height / 2;\n\n  parent.append(\"rect\")\n    .attr(\"x\", startX)\n    .attr(\"y\", startY)\n    .attr(\"width\", block.width)\n    .attr(\"height\", block.height)\n    .attr(\"class\", block.style);\n\n  var current = parent.append(\"text\")\n    .attr(\"x\", block.x)\n    .attr(\"y\", startY + 20)\n    .attr(\"fill\", \"white\")\n    .attr(\"text-anchor\", \"middle\")\n    .text(block.label);\n\n  if (block.childrens) {\n    for (var childIdx in block.childrens) {\n      var child = block.childrens[childIdx];\n\n      if (!child.width) child.width = block.width - 20;\n      if (!child.x) child.x = block.x;\n      if (child.position === undefined) child.position = childIdx;\n      if (child.style === undefined) child.style = \"block-children\";\n\n      var childBlock = {\n        x: child.x,\n        y: startY + 46 + child.position * 34,\n        width: child.width,\n        height: 30,\n        label: child.label,\n        style: child.style\n      };\n\n      drawBlock(parent, childBlock);\n    }\n  }\n\n  return block;\n}\n\nfunction linkBlocks(block1, block2, label) {\n  var block1right = block1.x + block1.width / 2;\n  var block2left = block2.x - block2.width / 2;\n  var block1bottom = block1.y + block1.height / 2;\n  var block2top = block2.y - block2.height / 2;\n\n  var horizontal = block1right < block2left;\n\n  root.append('line')\n    .attr(\"x1\", horizontal ? block1right : block1.x)\n    .attr(\"y1\", horizontal ? block1.y : block1bottom)\n    .attr(\"x2\", horizontal ? block2left : block2.x)\n    .attr(\"y2\", horizontal ? block2.y : block2top)\n  \t.attr(\"class\", \"block-link\")\n  \t.attr(\"stroke-width\", \"1\")\n  \t.attr(\"marker-start\", \"url(#circle)\")\n  \t.attr(\"marker-end\", \"url(#circle)\")\n  \t.attr(\"stroke-dasharray\", \"3,7\");\n\n  var labelFits = horizontal ?\n    Math.abs(block2left - block1right) > block1.width / 2 :\n    Math.abs(block2top - block1bottom) > 30;\n\n  if (label && labelFits) {\n    root.append('text')\n      .attr(\"dy\", (horizontal ? \"-\" : \"\") + \"0.4em\")\n      .attr(\"x\", block1right + (block2left - block1right) / 2)\n      .attr(\"y\", block1bottom + (block2top - block1bottom) / 2)\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"fill\", \"#759cc7\")\n      .text(label);\n  }\n}\nsvg = d3.select(svg.node());\n/* R2D3 Source File:  images/06-connections-livy.js */\n// !preview r2d3 dependencies=\"images/06-connections-diagram.js\", css=\"images/06-connections-diagram.css\"\n//\n// r2d3: https://rstudio.github.io/r2d3\n//\n\nvar root = diagramRoot(600);\nvar blockWidth = width / 4.0;\n\nvar totalWorkers = 3;\nvar blockHeight = height / totalWorkers - 10;\n\nvar sparklyrBlock = drawBlock(root, {\n  x: blockWidth / 2,\n  y: blockHeight / 3,\n  height: height / 4,\n  label: \"R\",\n  childrens: [{\n    label: \"sparklyr\"\n  }]\n});\n\nvar driverBlock = drawBlock(root, {\n  x: blockWidth / 2,\n  y: height / 2,\n  height: height / 3 - 10,\n  label: \"Driver\",\n  childrens: [{\n    label: \"Livy Service\"\n  }, {\n    label: \"Spark Context\"\n  }]\n});\n\nlinkBlocks(sparklyrBlock, driverBlock, \"Web API\");\n\nvar clusterBlock = drawBlock(root, {\n  x: width / 2,\n  y: height / 2,\n  height: 30,\n  label: \"Cluster Manager\"\n});\n\nlinkBlocks(driverBlock, clusterBlock);\n\nvar workers = new Array(totalWorkers);\nfor (var i = 0; i < totalWorkers; i++) {\n  workers[i] = drawBlock(root, {\n    x: width - blockWidth / 2,\n    y: 5 + blockHeight / 2 + height / totalWorkers * i,\n    height: blockHeight,\n    label: \"Worker\",\n    childrens: [{\n      label: \"Spark Executor\",\n      color: \"#759cc7\"\n    }, {\n      label: \"Spark Executor\",\n      color: \"#759cc7\"\n    }]\n  });\n}\n\nfor (var i = 0; i < workers.length; i++) {\n  linkBlocks(clusterBlock, workers[i]);\n}\n};","style":"/* R2D3 Source File:  images/06-connections-diagram.css */\n.block {\n  fill: #bbcce0;\n}\n\n.block-children {\n  fill:  #93acc7;\n}\n\n.block-link {\n  fill: white;\n  stroke: #bbcce0;\n}","version":5,"theme":{"default":{"background":"#FFFFFF","foreground":"#000000"},"runtime":null},"useShadow":true},"evals":[],"jsHooks":[]}</script>
<p class="caption">
FIGURE 6.7: Livy Connection Diagram
</p>
</div>
<p>Conencting through Livy requires the URL to the Livy service which should be similar to <code>https://hostname:port/livy</code>. Since remote connections are allowed, connections usually requires, at the very least, basic authentication:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1">sc &lt;-<span class="st"> </span><span class="kw">spark_connect</span>(<span class="dt">master =</span> <span class="st">&quot;https://hostname:port/livy&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;livy&quot;</span>, <span class="dt">config =</span> <span class="kw">livy_config</span>(</a>
<a class="sourceLine" id="cb44-2" data-line-number="2">  <span class="dt">username=</span><span class="st">&quot;&lt;username&gt;&quot;</span>,</a>
<a class="sourceLine" id="cb44-3" data-line-number="3">  <span class="dt">password=</span><span class="st">&quot;&lt;password&gt;&quot;</span></a>
<a class="sourceLine" id="cb44-4" data-line-number="4">))</a></code></pre></div>
<p>Once connected through Livy, operations you can make use of an other <code>sparklyr</code> feature; however, Livy is not suitable for experimental data analysis, since executing commands have a significant delay; that said, while running long running computations, this overhead could be considered irrelevant. In general, it is preffered to avoid using Livy and work directly within an edge node in the cluster; if this is not feasible, using Livy could be a reasonable approach.</p>
</div>
<div id="mesos-1" class="section level3">
<h3><span class="header-section-number">6.2.5</span> Mesos</h3>
<p>Similar to YARN, Mesos supports client mode and a cluster mode. However, <code>sparklyr</code> currently only supports client mode for Mesos.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-56"></span>
<div id="htmlwidget-e9e68a732b211c007912" style="width:100%;height:480px;" class="r2d3 html-widget"></div>
<script type="application/json" data-for="htmlwidget-e9e68a732b211c007912">{"x":{"data":null,"type":"NULL","container":"svg","options":null,"script":"var d3Script = function(d3, r2d3, data, svg, width, height, options, theme, console) {\nthis.d3 = d3;\n/* R2D3 Source File:  images/06-connections-diagram.js */\n\nsvg.append(\"svg:defs\").append(\"svg:marker\")\n  .attr(\"id\", \"circle\")\n  .attr(\"refX\", 6)\n  .attr(\"refY\", 6)\n  .attr(\"markerWidth\", 12)\n  .attr(\"markerHeight\", 12)\n  .attr(\"orient\", \"auto\")\n  .append(\"circle\")\n  .attr(\"cx\", \"6\")\n  .attr(\"cy\", \"6\")\n  .attr(\"r\", \"3\")\n  .attr(\"class\", \"block-link\")\n  .attr(\"stroke-width\", 1);\n\nfunction diagramRoot(maxWidth) {\n  if (!maxWidth) maxWidth = 500;\n\n  var scaleX = 1;\n  var scaleY = 1;\n  height = height - 20;\n\n  var newWidth = width > maxWidth ? maxWidth : width;\n  var translateX = width > newWidth ? (width - newWidth) / 2 : 0;\n  var translateY = 10;\n  width = newWidth;\n\n  svg\n    .attr(\"font-size\", Math.min(width, 500) / 600 + \"em\")\n    .attr(\"font-family\", \"sans-serif\");\n\n  var root = svg.append(\"g\")\n    .attr(\"transform\", \"translate(\" + translateX + \",\" + translateY + \")scale(\" + scaleX + \",\" + scaleY + \")\");\n\n  return root;\n}\n\nfunction drawBlock(parent, block) {\n  if (!block.x) block.x = 0;\n  if (!block.y) block.y = 0;\n  if (!block.width) block.width = blockWidth;\n  if (!block.height) block.height = blockHeight;\n  if (!block.color) block.color = \"#bbcce0\";\n  if (!block.label) block.label = \"<label>\";\n  if (!block.style) block.style = \"block\";\n\n  var startX = block.x - block.width / 2;\n  var startY = block.y - block.height / 2;\n\n  parent.append(\"rect\")\n    .attr(\"x\", startX)\n    .attr(\"y\", startY)\n    .attr(\"width\", block.width)\n    .attr(\"height\", block.height)\n    .attr(\"class\", block.style);\n\n  var current = parent.append(\"text\")\n    .attr(\"x\", block.x)\n    .attr(\"y\", startY + 20)\n    .attr(\"fill\", \"white\")\n    .attr(\"text-anchor\", \"middle\")\n    .text(block.label);\n\n  if (block.childrens) {\n    for (var childIdx in block.childrens) {\n      var child = block.childrens[childIdx];\n\n      if (!child.width) child.width = block.width - 20;\n      if (!child.x) child.x = block.x;\n      if (child.position === undefined) child.position = childIdx;\n      if (child.style === undefined) child.style = \"block-children\";\n\n      var childBlock = {\n        x: child.x,\n        y: startY + 46 + child.position * 34,\n        width: child.width,\n        height: 30,\n        label: child.label,\n        style: child.style\n      };\n\n      drawBlock(parent, childBlock);\n    }\n  }\n\n  return block;\n}\n\nfunction linkBlocks(block1, block2, label) {\n  var block1right = block1.x + block1.width / 2;\n  var block2left = block2.x - block2.width / 2;\n  var block1bottom = block1.y + block1.height / 2;\n  var block2top = block2.y - block2.height / 2;\n\n  var horizontal = block1right < block2left;\n\n  root.append('line')\n    .attr(\"x1\", horizontal ? block1right : block1.x)\n    .attr(\"y1\", horizontal ? block1.y : block1bottom)\n    .attr(\"x2\", horizontal ? block2left : block2.x)\n    .attr(\"y2\", horizontal ? block2.y : block2top)\n  \t.attr(\"class\", \"block-link\")\n  \t.attr(\"stroke-width\", \"1\")\n  \t.attr(\"marker-start\", \"url(#circle)\")\n  \t.attr(\"marker-end\", \"url(#circle)\")\n  \t.attr(\"stroke-dasharray\", \"3,7\");\n\n  var labelFits = horizontal ?\n    Math.abs(block2left - block1right) > block1.width / 2 :\n    Math.abs(block2top - block1bottom) > 30;\n\n  if (label && labelFits) {\n    root.append('text')\n      .attr(\"dy\", (horizontal ? \"-\" : \"\") + \"0.4em\")\n      .attr(\"x\", block1right + (block2left - block1right) / 2)\n      .attr(\"y\", block1bottom + (block2top - block1bottom) / 2)\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"fill\", \"#759cc7\")\n      .text(label);\n  }\n}\nsvg = d3.select(svg.node());\n/* R2D3 Source File:  images/06-connections-mesos.js */\n// !preview r2d3 dependencies=\"images/06-connections-diagram.js\", css=\"images/06-connections-diagram.css\"\n//\n// r2d3: https://rstudio.github.io/r2d3\n//\n\nvar root = diagramRoot(600);\nvar blockWidth = width / 4.0;\n\nvar totalWorkers = 3;\nvar blockHeight = height / totalWorkers - 10;\n\nvar driverBlock = drawBlock(root, {\n  x: blockWidth / 2,\n  y: height / 2,\n  height: 150,\n  label: \"Driver\",\n  childrens: [{\n    label: \"R\"\n  }, {\n    label: \"sparklyr\"\n  }, {\n    label: \"Spark Context\"\n  }]\n});\n\nvar clusterBlock = drawBlock(root, {\n  x: width / 2,\n  y: height / 2,\n  height: 80,\n  label: \"Cluster Manager\",\n  childrens: [{\n    label: \"Mesos\"\n  }]\n});\n\nvar workers = new Array(totalWorkers);\nfor (var i = 0; i < totalWorkers; i++) {\n  workers[i] = drawBlock(root, {\n    x: width - blockWidth / 2,\n    y: 5 + blockHeight / 2 + height / totalWorkers * i,\n    height: blockHeight,\n    label: \"Worker\",\n    childrens: [{\n      label: \"Spark Executor\",\n      color: \"#759cc7\"\n    }, {\n      label: \"Spark Executor\",\n      color: \"#759cc7\"\n    }]\n  });\n}\n\nlinkBlocks(driverBlock, clusterBlock);\nfor (var i = 0; i < workers.length; i++) {\n  linkBlocks(clusterBlock, workers[i]);\n}\n};","style":"/* R2D3 Source File:  images/06-connections-diagram.css */\n.block {\n  fill: #bbcce0;\n}\n\n.block-children {\n  fill:  #93acc7;\n}\n\n.block-link {\n  fill: white;\n  stroke: #bbcce0;\n}","version":5,"theme":{"default":{"background":"#FFFFFF","foreground":"#000000"},"runtime":null},"useShadow":true},"evals":[],"jsHooks":[]}</script>
<p class="caption">
FIGURE 6.8: Mesos Connection Diagram
</p>
</div>
<p>Connecting requires the address to the Mesos master node, usually in the form of <code>mesos://host:port</code> or <code>mesos://zk://host1:2181,host2:2181,host3:2181/mesos</code> for Mesos using ZooKeeper.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1">sc &lt;-<span class="st"> </span><span class="kw">spark_connect</span>(<span class="dt">master =</span> <span class="st">&quot;mesos://host:port&quot;</span>)</a></code></pre></div>
</div>
<div id="kubernetes-1" class="section level3">
<h3><span class="header-section-number">6.2.6</span> Kubernetes</h3>
<p>Kubernetes cluster do not support client modes similar to Mesos or YARN, instead, the connection model is similar to YARN Cluster, where the driver node is assigned by Kubernetes.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-58"></span>
<div id="htmlwidget-35d03977751330ff5b67" style="width:100%;height:480px;" class="r2d3 html-widget"></div>
<script type="application/json" data-for="htmlwidget-35d03977751330ff5b67">{"x":{"data":null,"type":"NULL","container":"svg","options":null,"script":"var d3Script = function(d3, r2d3, data, svg, width, height, options, theme, console) {\nthis.d3 = d3;\n/* R2D3 Source File:  images/06-connections-diagram.js */\n\nsvg.append(\"svg:defs\").append(\"svg:marker\")\n  .attr(\"id\", \"circle\")\n  .attr(\"refX\", 6)\n  .attr(\"refY\", 6)\n  .attr(\"markerWidth\", 12)\n  .attr(\"markerHeight\", 12)\n  .attr(\"orient\", \"auto\")\n  .append(\"circle\")\n  .attr(\"cx\", \"6\")\n  .attr(\"cy\", \"6\")\n  .attr(\"r\", \"3\")\n  .attr(\"class\", \"block-link\")\n  .attr(\"stroke-width\", 1);\n\nfunction diagramRoot(maxWidth) {\n  if (!maxWidth) maxWidth = 500;\n\n  var scaleX = 1;\n  var scaleY = 1;\n  height = height - 20;\n\n  var newWidth = width > maxWidth ? maxWidth : width;\n  var translateX = width > newWidth ? (width - newWidth) / 2 : 0;\n  var translateY = 10;\n  width = newWidth;\n\n  svg\n    .attr(\"font-size\", Math.min(width, 500) / 600 + \"em\")\n    .attr(\"font-family\", \"sans-serif\");\n\n  var root = svg.append(\"g\")\n    .attr(\"transform\", \"translate(\" + translateX + \",\" + translateY + \")scale(\" + scaleX + \",\" + scaleY + \")\");\n\n  return root;\n}\n\nfunction drawBlock(parent, block) {\n  if (!block.x) block.x = 0;\n  if (!block.y) block.y = 0;\n  if (!block.width) block.width = blockWidth;\n  if (!block.height) block.height = blockHeight;\n  if (!block.color) block.color = \"#bbcce0\";\n  if (!block.label) block.label = \"<label>\";\n  if (!block.style) block.style = \"block\";\n\n  var startX = block.x - block.width / 2;\n  var startY = block.y - block.height / 2;\n\n  parent.append(\"rect\")\n    .attr(\"x\", startX)\n    .attr(\"y\", startY)\n    .attr(\"width\", block.width)\n    .attr(\"height\", block.height)\n    .attr(\"class\", block.style);\n\n  var current = parent.append(\"text\")\n    .attr(\"x\", block.x)\n    .attr(\"y\", startY + 20)\n    .attr(\"fill\", \"white\")\n    .attr(\"text-anchor\", \"middle\")\n    .text(block.label);\n\n  if (block.childrens) {\n    for (var childIdx in block.childrens) {\n      var child = block.childrens[childIdx];\n\n      if (!child.width) child.width = block.width - 20;\n      if (!child.x) child.x = block.x;\n      if (child.position === undefined) child.position = childIdx;\n      if (child.style === undefined) child.style = \"block-children\";\n\n      var childBlock = {\n        x: child.x,\n        y: startY + 46 + child.position * 34,\n        width: child.width,\n        height: 30,\n        label: child.label,\n        style: child.style\n      };\n\n      drawBlock(parent, childBlock);\n    }\n  }\n\n  return block;\n}\n\nfunction linkBlocks(block1, block2, label) {\n  var block1right = block1.x + block1.width / 2;\n  var block2left = block2.x - block2.width / 2;\n  var block1bottom = block1.y + block1.height / 2;\n  var block2top = block2.y - block2.height / 2;\n\n  var horizontal = block1right < block2left;\n\n  root.append('line')\n    .attr(\"x1\", horizontal ? block1right : block1.x)\n    .attr(\"y1\", horizontal ? block1.y : block1bottom)\n    .attr(\"x2\", horizontal ? block2left : block2.x)\n    .attr(\"y2\", horizontal ? block2.y : block2top)\n  \t.attr(\"class\", \"block-link\")\n  \t.attr(\"stroke-width\", \"1\")\n  \t.attr(\"marker-start\", \"url(#circle)\")\n  \t.attr(\"marker-end\", \"url(#circle)\")\n  \t.attr(\"stroke-dasharray\", \"3,7\");\n\n  var labelFits = horizontal ?\n    Math.abs(block2left - block1right) > block1.width / 2 :\n    Math.abs(block2top - block1bottom) > 30;\n\n  if (label && labelFits) {\n    root.append('text')\n      .attr(\"dy\", (horizontal ? \"-\" : \"\") + \"0.4em\")\n      .attr(\"x\", block1right + (block2left - block1right) / 2)\n      .attr(\"y\", block1bottom + (block2top - block1bottom) / 2)\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"fill\", \"#759cc7\")\n      .text(label);\n  }\n}\nsvg = d3.select(svg.node());\n/* R2D3 Source File:  images/06-connections-kubernetes.js */\n// !preview r2d3 dependencies=\"images/06-connections-diagram.js\", css=\"images/06-connections-diagram.css\"\n//\n// r2d3: https://rstudio.github.io/r2d3\n//\n\nvar root = diagramRoot(600);\nvar blockWidth = width / 4.0;\n\nvar totalWorkers = 3;\nvar blockHeight = height / totalWorkers - 10;\n\nvar sparklyrBlock = drawBlock(root, {\n  x: blockWidth / 2,\n  y: blockHeight / 3,\n  height: height / 4,\n  label: \"R\",\n  childrens: [{\n    label: \"sparklyr\"\n  }]\n});\n\nvar driverBlock = drawBlock(root, {\n  x: blockWidth / 2,\n  y: height / 2,\n  height: height / 4,\n  label: \"Driver\",\n  childrens: [{\n    label: \"Spark Context\"\n  }]\n});\n\nvar clusterBlock = drawBlock(root, {\n  x: width / 2,\n  y: height / 2,\n  height: 80,\n  label: \"Cluster Manager\",\n  childrens: [{\n    label: \"Kubernetes\"\n  }]\n});\n\nlinkBlocks(sparklyrBlock, clusterBlock);\nlinkBlocks(driverBlock, clusterBlock);\n\nvar workers = new Array(totalWorkers);\nfor (var i = 0; i < totalWorkers; i++) {\n  workers[i] = drawBlock(root, {\n    x: width - blockWidth / 2,\n    y: 5 + blockHeight / 2 + height / totalWorkers * i,\n    height: blockHeight,\n    label: \"Worker\",\n    childrens: [{\n      label: \"Spark Executor\",\n      color: \"#759cc7\"\n    }, {\n      label: \"Spark Executor\",\n      color: \"#759cc7\"\n    }]\n  });\n}\n\nfor (var i = 0; i < workers.length; i++) {\n  linkBlocks(clusterBlock, workers[i]);\n}\n};","style":"/* R2D3 Source File:  images/06-connections-diagram.css */\n.block {\n  fill: #bbcce0;\n}\n\n.block-children {\n  fill:  #93acc7;\n}\n\n.block-link {\n  fill: white;\n  stroke: #bbcce0;\n}","version":5,"theme":{"default":{"background":"#FFFFFF","foreground":"#000000"},"runtime":null},"useShadow":true},"evals":[],"jsHooks":[]}</script>
<p class="caption">
FIGURE 6.9: Kubernetes Connection Diagram
</p>
</div>
<p>Kubernetes support is scheduled to be added to <code>sparklyr</code> with <a href="https://github.com/rstudio/sparklyr/issues/1525">sparklyr/issues/1525</a>, please follow progress for this feature directly in github. Once Kubernetes becomes supported in <code>sparklyr</code>, connecting to Kubernetes will work as follows:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1">sc &lt;-<span class="st"> </span><span class="kw">spark_connect</span>(</a>
<a class="sourceLine" id="cb46-2" data-line-number="2">  <span class="dt">master =</span> <span class="st">&quot;k8s://https://&lt;apiserver-host&gt;:&lt;apiserver-port&gt;&quot;</span></a>
<a class="sourceLine" id="cb46-3" data-line-number="3">  <span class="dt">config =</span> <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb46-4" data-line-number="4">    <span class="dt">spark.executor.instances =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb46-5" data-line-number="5">    <span class="dt">spark.kubernetes.container.image =</span> <span class="st">&quot;spark-image&quot;</span></a>
<a class="sourceLine" id="cb46-6" data-line-number="6">  )</a>
<a class="sourceLine" id="cb46-7" data-line-number="7">)</a></code></pre></div>
<p>If your computer is already configured to use a Kubernetes cluster, you can use the following commmand to find the <code>apiserver-host</code> and <code>apiserver-port</code>:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="kw">system2</span>(<span class="st">&quot;kubectl&quot;</span>, <span class="st">&quot;cluster-info&quot;</span>)</a></code></pre></div>
</div>
</div>
<div id="troubleshooting" class="section level2">
<h2><span class="header-section-number">6.3</span> Troubleshooting</h2>
<div id="logging" class="section level3">
<h3><span class="header-section-number">6.3.1</span> Logging</h3>
<p>One first step is to troubleshoot connections is to run in verbose to print directly to the console additional error messages:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1">sc &lt;-<span class="st"> </span><span class="kw">spark_connect</span>(<span class="dt">master =</span> <span class="st">&quot;local&quot;</span>, <span class="dt">log =</span> <span class="st">&quot;console&quot;</span>)</a></code></pre></div>
<pre><code>## Re-using existing Spark connection to local</code></pre>
<p>Verbose logging can also be enabled with the follwing option:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="kw">options</span>(<span class="dt">sparklyr.verbose =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
</div>
<div id="troubleshoot-spark-submit" class="section level3">
<h3><span class="header-section-number">6.3.2</span> Spark Submit</h3>
<p>If connections fail in <code>sparklyr</code>, first troubleshoot if this issue is specific to <code>sparklyr</code> or Spark in general. This can be accomplished by running an example <code>spark-submit</code> job and validating that no errors are thrown:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="co"># Find the spark directory using an environment variable</span></a>
<a class="sourceLine" id="cb51-2" data-line-number="2"><span class="kw">Sys.getenv</span>(<span class="st">&quot;SPARK_HOME&quot;</span>)</a>
<a class="sourceLine" id="cb51-3" data-line-number="3"></a>
<a class="sourceLine" id="cb51-4" data-line-number="4"><span class="co"># Or by getting the local spark installation</span></a>
<a class="sourceLine" id="cb51-5" data-line-number="5">sparklyr<span class="op">::</span><span class="kw">spark_home_dir</span>()</a></code></pre></div>
<p>From the terminal run:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb52-1" data-line-number="1"><span class="bu">cd</span> path/to/spark/</a>
<a class="sourceLine" id="cb52-2" data-line-number="2"><span class="ex">bin/spark-submit</span> </a></code></pre></div>
</div>
<div id="multiple" class="section level3">
<h3><span class="header-section-number">6.3.3</span> Multiple</h3>
<p>It is common to connect once, and only once, to Spark. However, you can also open multiple connections to Spark by connecting to different clusters or by specifying the <code>app_name</code> parameter, this can be helpful to compare Spark versions or validate you analysis before submitting to the cluster. The following example opens connections to Spark 1.6.3, 2.3.0 and Spark Standalone:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1"><span class="co"># Connect to local Spark 1.6.3</span></a>
<a class="sourceLine" id="cb53-2" data-line-number="2">sc_<span class="dv">1</span>_<span class="dv">6</span>_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">spark_connect</span>(<span class="dt">master =</span> <span class="st">&quot;local&quot;</span>, <span class="dt">version =</span> <span class="st">&quot;1.6.3&quot;</span>)</a>
<a class="sourceLine" id="cb53-3" data-line-number="3"></a>
<a class="sourceLine" id="cb53-4" data-line-number="4"><span class="co"># Connect to local Spark 2.3.0</span></a>
<a class="sourceLine" id="cb53-5" data-line-number="5">sc_<span class="dv">2</span>_<span class="dv">3</span>_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="kw">spark_connect</span>(<span class="dt">master =</span> <span class="st">&quot;local&quot;</span>, <span class="dt">version =</span> <span class="st">&quot;2.3.0&quot;</span>, <span class="dt">appName =</span> <span class="st">&quot;Spark23&quot;</span>)</a>
<a class="sourceLine" id="cb53-6" data-line-number="6"></a>
<a class="sourceLine" id="cb53-7" data-line-number="7"><span class="co"># Connect to local Spark Standalone</span></a>
<a class="sourceLine" id="cb53-8" data-line-number="8">sc_standalone &lt;-<span class="st"> </span><span class="kw">spark_connect</span>(<span class="dt">master =</span> <span class="st">&quot;spark://host:port&quot;</span>)</a></code></pre></div>
<p>Finally, we can disconnect from each connection:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1"><span class="kw">spark_disconnect</span>(sc_<span class="dv">1</span>_<span class="dv">6</span>_<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb54-2" data-line-number="2"><span class="kw">spark_disconnect</span>(sc_<span class="dv">2</span>_<span class="dv">3</span>_<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb54-3" data-line-number="3"><span class="kw">spark_disconnect</span>(sc_standalone)</a></code></pre></div>
<p>Alternatevely, you can disconnect from all connections at once:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1"><span class="kw">spark_disconnect_all</span>()</a></code></pre></div>
</div>
<div id="windows" class="section level3">
<h3><span class="header-section-number">6.3.4</span> Windows</h3>
<p>Connecting from Windows is, in most cases, as straightforward as connecting from Linux or OS X; however, there are a few common connection issues you might hit t</p>
<ul>
<li>Firewalls and atni-viruse software might block ports for your connection. The default port used by <code>sparklyr</code> is <code>8880</code>, double check this port is not being blocked.</li>
<li>Long path names can cause issues in, specially, older Windows systems like Windows 7. When using these systems, try connecting with Spark installed with all folders using 8 characters or less.</li>
</ul>
</div>
<div id="submit-manually" class="section level3">
<h3><span class="header-section-number">6.3.5</span> Submit Manually</h3>
<p>To troubleshoot Windows connections in detail, you can use a 2-step initialization that is often very helpful to diagnose connection issues.</p>
<p>This 2-step initialization os performed by launching <code>sparklyr</code> through <code>spark-submit</code> followed by connecting with <code>sparklyr</code> from R.</p>
<p>First, <a href="troubleshoot-spark-submit">identify the Spark installation directory</a>. Second, identify the path to the correct <code>sparklyr*.jar</code>, you can find this path by running;</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1"><span class="kw">dir</span>(<span class="kw">system.file</span>(<span class="st">&quot;java&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;sparklyr&quot;</span>), <span class="dt">pattern =</span> <span class="st">&quot;sparklyr&quot;</span>, <span class="dt">full.names =</span> T)</a></code></pre></div>
<pre><code>## [1] &quot;/Library/Frameworks/R.framework/Versions/3.5/Resources/library/sparklyr/java/sparklyr-1.5-2.10.jar&quot;
## [2] &quot;/Library/Frameworks/R.framework/Versions/3.5/Resources/library/sparklyr/java/sparklyr-1.6-2.10.jar&quot;
## [3] &quot;/Library/Frameworks/R.framework/Versions/3.5/Resources/library/sparklyr/java/sparklyr-2.0-2.11.jar&quot;
## [4] &quot;/Library/Frameworks/R.framework/Versions/3.5/Resources/library/sparklyr/java/sparklyr-2.1-2.11.jar&quot;
## [5] &quot;/Library/Frameworks/R.framework/Versions/3.5/Resources/library/sparklyr/java/sparklyr-2.2-2.11.jar&quot;
## [6] &quot;/Library/Frameworks/R.framework/Versions/3.5/Resources/library/sparklyr/java/sparklyr-2.3-2.11.jar&quot;</code></pre>
<p>Make sure you identify the correct version that matches your Spark cluster, for isntance <code>sparklyr-2.1-2.11.jar</code> for Spark 2.1.</p>
<p>Third, from the terminal run:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb58-1" data-line-number="1"><span class="va">$SPARK_HOME</span><span class="ex">/bin/spark-submit</span> --class sparklyr.Shell <span class="va">$PATH_TO_SPARKLYR_JAR</span> 8880 12345</a></code></pre></div>
<pre><code>18/06/11 12:13:53 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
18/06/11 12:13:53 INFO sparklyr: Session (12345) is starting under 127.0.0.1 port 8880
18/06/11 12:13:53 INFO sparklyr: Session (12345) found port 8880 is available
18/06/11 12:13:53 INFO sparklyr: Gateway (12345) is waiting for sparklyr client to connect to port 8880</code></pre>
<p>The parameter <code>8880</code> represents the default port to use in <code>sparklyr</code> while <code>12345</code> is the session number, this is a cryptographically secure number generated by <code>sparklyr</code>, but for troubleshooting purpuses can be as simple as <code>12345</code>.</p>
<p>Then, from R, connect as follows, notice that there is a 60 seconds timeout, so you’ll have to run the R command immediately after running the terminal command:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1"><span class="kw">library</span>(sparklyr)</a>
<a class="sourceLine" id="cb60-2" data-line-number="2">sc &lt;-<span class="st"> </span><span class="kw">spark_connect</span>(<span class="dt">master =</span> <span class="st">&quot;sparklyr://localhost:8880/12345&quot;</span>, <span class="dt">version =</span> <span class="st">&quot;2.3&quot;</span>)</a></code></pre></div>
</div>
</div>
<div id="recap-2" class="section level2">
<h2><span class="header-section-number">6.4</span> Recap</h2>
<p>This chapter presented an overview of Spark’s architecture and detailed connections concepts and examples to connect in local mode, standalone, YARN, Mesos, Kubernetes and Livy. It also presented edge nodes and their role while connecting to Spark clusters. This information should give you enough information to effectevely connect to any cluster with Apache Spark enabled.</p>
<p>To troubleshoot connection problems, it is recommended to search for the connection problem in StackOverflow, the <a href="https://github.com/rstudio/sparklyr/issues">sparklyr github issues</a> and, if needed, open a <a href="https://github.com/rstudio/sparklyr/issues/new">new GitHub issue in sparklyr</a> to assist further.</p>
<p>In the next chapter, <a href="data.html#data">Data</a>, you will learn how to read and write over multiple data sources and understand in-depth what a Spark dataframe is.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="clusters.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["the-r-in-spark.pdf", "the-r-in-spark.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
